============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\JordanEhrig\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\JordanEhrig\Documents\GitHub\DWG-forensic-tool
configfile: pyproject.toml
plugins: anyio-4.12.1, cov-7.0.0
collecting ... collected 1274 items

tests/test_advanced_anomalies.py::TestTDINDWGAnomalies::test_tdindwg_exceeds_span_detected PASSED [  0%]
tests/test_advanced_anomalies.py::TestTDINDWGAnomalies::test_tdindwg_valid_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestTDINDWGAnomalies::test_tdindwg_none_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestTDINDWGAnomalies::test_tdindwg_equal_to_span_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestVersionAnachronism::test_anachronism_detected PASSED [  0%]
tests/test_advanced_anomalies.py::TestVersionAnachronism::test_no_anachronism_valid_date PASSED [  0%]
tests/test_advanced_anomalies.py::TestVersionAnachronism::test_no_tdcreate_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestVersionAnachronism::test_unknown_version_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestTimezoneDiscrepancy::test_invalid_timezone_offset_detected PASSED [  0%]
tests/test_advanced_anomalies.py::TestTimezoneDiscrepancy::test_valid_timezone_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestTimezoneDiscrepancy::test_no_data_no_anomaly PASSED [  0%]
tests/test_advanced_anomalies.py::TestTimestampPrecision::test_midnight_timestamp_detected PASSED [  0%]
tests/test_advanced_anomalies.py::TestTimestampPrecision::test_zero_editing_time_detected PASSED [  1%]
tests/test_advanced_anomalies.py::TestTimestampPrecision::test_normal_timestamp_no_anomaly PASSED [  1%]
tests/test_advanced_anomalies.py::TestEducationalWatermark::test_educational_watermark_detected PASSED [  1%]
tests/test_advanced_anomalies.py::TestEducationalWatermark::test_no_educational_watermark PASSED [  1%]
tests/test_advanced_anomalies.py::TestAdvancedTimestampAnomalies::test_runs_all_detectors PASSED [  1%]
tests/test_advanced_anomalies.py::TestAdvancedTimestampAnomalies::test_clean_file_no_anomalies PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_release_date PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_name PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_is_date_before_version_release PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_could_file_exist_at_date PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_release_date_unknown PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_name_unknown PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_span PASSED [  1%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_version_span_unknown PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_is_date_before_version_release_naive_datetime PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_is_date_before_version_release_unknown_version PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_anachronism_details PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_anachronism_details_no_anachronism PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_anachronism_details_naive_datetime PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_could_file_exist_at_date_unknown_version PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_could_file_exist_at_date_naive_datetime PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_expected_version_for_date PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_expected_version_for_date_naive_datetime PASSED [  2%]
tests/test_advanced_anomalies.py::TestVersionDates::test_get_expected_version_for_date_before_dwg PASSED [  2%]
tests/test_analysis.py::TestAnomalyDetector::test_init_creates_instance PASSED [  2%]
tests/test_analysis.py::TestAnomalyDetector::test_detect_version_anomalies_valid PASSED [  2%]
tests/test_analysis.py::TestAnomalyDetector::test_detect_version_anomalies_unsupported PASSED [  3%]
tests/test_analysis.py::TestAnomalyDetector::test_detect_structural_anomalies_valid PASSED [  3%]
tests/test_analysis.py::TestAnomalyDetector::test_detect_structural_anomalies_small_file PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_init_loads_builtin_rules PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_builtin_rule_ids PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_evaluate_header_crc_valid PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_evaluate_header_crc_invalid PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_get_failed_rules PASSED [  3%]
tests/test_analysis.py::TestTamperingRuleEngine::test_custom_rules_loading PASSED [  3%]
tests/test_analysis.py::TestRiskScorer::test_init_creates_instance PASSED [  3%]
tests/test_analysis.py::TestRiskScorer::test_calculate_score_empty PASSED [  3%]
tests/test_analysis.py::TestRiskScorer::test_calculate_score_with_anomalies PASSED [  3%]
tests/test_analysis.py::TestRiskScorer::test_score_to_risk_level_low PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_score_to_risk_level_medium PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_score_to_risk_level_high PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_score_to_risk_level_critical PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_factors_with_valid_data PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_factors_with_failures PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_recommendation_low PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_recommendation_critical PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_calculate_score_with_risklevel_severity PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_calculate_confidence_with_metadata PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_calculate_confidence_with_many_anomalies PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_factors_with_critical_anomalies PASSED [  4%]
tests/test_analysis.py::TestRiskScorer::test_generate_factors_empty_no_issues PASSED [  4%]
tests/test_analysis.py::TestPhase3Integration::test_full_tampering_analysis_flow PASSED [  5%]
tests/test_analysis.py::TestPhase3Integration::test_tampering_detected_workflow PASSED [  5%]
tests/test_analysis.py::TestRuleResult::test_rule_result_creation PASSED [  5%]
tests/test_analysis.py::TestRuleResult::test_rule_result_with_details PASSED [  5%]
tests/test_analysis.py::TestTamperingReport::test_tampering_report_creation PASSED [  5%]
tests/test_analysis.py::TestTamperingReport::test_tampering_report_with_findings PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorTimestamps::test_created_after_modified PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorTimestamps::test_modified_in_future PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorTimestamps::test_editing_time_exceeds_span PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorTimestamps::test_filesystem_vs_internal_mismatch PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorTimestamps::test_naive_datetime_handling PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorVersionMarkers::test_multiple_version_markers PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorStructural::test_detect_all_method PASSED [  5%]
tests/test_analysis.py::TestAnomalyDetectorStructural::test_detect_all_without_metadata PASSED [  6%]
tests/test_analysis.py::TestAnomalyDetectorStructural::test_calculate_null_ratio_empty_data PASSED [  6%]
tests/test_analysis.py::TestAnomalyDetectorStructural::test_check_slack_space_repeated_pattern PASSED [  6%]
tests/test_analysis.py::TestTimezoneDiscrepancyEdgeCases::test_non_standard_timezone_offset PASSED [  6%]
tests/test_analysis.py::TestVersionAnachronismEdgeCases::test_anachronism_invalid_mjd PASSED [  6%]
tests/test_analysis.py::TestRuleEngineLoadRules::test_load_rules_with_none PASSED [  6%]
tests/test_analysis.py::TestRuleEngineLoadRules::test_load_rules_missing_file PASSED [  6%]
tests/test_analysis.py::TestRuleEngineLoadRules::test_load_rules_json_format PASSED [  6%]
tests/test_analysis.py::TestRuleEngineLoadRules::test_load_rules_unsupported_format PASSED [  6%]
tests/test_analysis.py::TestRuleEngineLoadRules::test_load_rules_invalid_structure PASSED [  6%]
tests/test_analysis.py::TestRuleEngineEvaluation::test_evaluate_disabled_rule PASSED [  6%]
tests/test_analysis.py::TestRuleEngineEvaluation::test_evaluate_custom_rule_with_condition PASSED [  6%]
tests/test_analysis.py::TestRuleEngineEvaluation::test_evaluate_unknown_rule_id PASSED [  6%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_not_equals PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_greater_than PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_less_than PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_contains PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_not_contains PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_exists PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_not_exists PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_nested_field PASSED [  7%]
tests/test_analysis.py::TestConditionEvaluation::test_condition_invalid_path PASSED [  7%]
tests/test_analysis.py::TestSectionCRCRule::test_section_crc_failure PASSED [  7%]
tests/test_analysis.py::TestTimestampRules::test_timestamp_reversal_with_strings PASSED [  7%]
tests/test_analysis.py::TestTimestampRules::test_future_timestamp_with_string PASSED [  7%]
tests/test_analysis.py::TestTimestampRules::test_edit_time_mismatch_with_strings PASSED [  8%]
tests/test_analysis.py::TestVersionDowngradeRule::test_version_downgrade_detection PASSED [  8%]
tests/test_analysis.py::TestNonAutodeskRule::test_non_autodesk_origin PASSED [  8%]
tests/test_analysis.py::TestOrphanedObjectsRule::test_orphaned_objects_detection PASSED [  8%]
tests/test_analysis.py::TestSlackSpaceRule::test_slack_space_detection PASSED [  8%]
tests/test_analysis.py::TestTDINDWGRule::test_tdindwg_manipulation_from_anomaly PASSED [  8%]
tests/test_analysis.py::TestTDINDWGRule::test_tdindwg_manipulation_from_data PASSED [  8%]
tests/test_analysis.py::TestVersionAnachronismRule::test_version_anachronism_from_anomaly PASSED [  8%]
tests/test_analysis.py::TestTimezoneDiscrepancyRule::test_timezone_discrepancy_from_anomaly PASSED [  8%]
tests/test_analysis.py::TestTimezoneDiscrepancyRule::test_timezone_discrepancy_from_data PASSED [  8%]
tests/test_analysis.py::TestEducationalWatermarkRule::test_educational_watermark_detection PASSED [  8%]
tests/test_analysis.py::TestTamperingScore::test_tampering_score_no_results PASSED [  8%]
tests/test_analysis.py::TestTamperingScore::test_tampering_score_with_failures PASSED [  8%]
tests/test_analysis.py::TestTDUSRTIMERResetRule::test_tdusrtimer_reset_detection PASSED [  9%]
tests/test_analysis.py::TestTDUSRTIMERResetRule::test_tdusrtimer_consistent PASSED [  9%]
tests/test_analysis.py::TestTDUSRTIMERResetRule::test_tdusrtimer_minimal_editing PASSED [  9%]
tests/test_analysis.py::TestTDUSRTIMERResetRule::test_tdusrtimer_from_metadata PASSED [  9%]
tests/test_analysis.py::TestTDUSRTIMERResetRule::test_tdusrtimer_inconclusive_no_data PASSED [  9%]
tests/test_analysis.py::TestNetworkPathLeakageRule::test_unc_path_detection PASSED [  9%]
tests/test_analysis.py::TestNetworkPathLeakageRule::test_url_path_detection PASSED [  9%]
tests/test_analysis.py::TestNetworkPathLeakageRule::test_no_network_paths PASSED [  9%]
tests/test_analysis.py::TestNetworkPathLeakageRule::test_xref_paths_extraction PASSED [  9%]
tests/test_analysis.py::TestNetworkPathLeakageRule::test_network_path_inconclusive_no_metadata PASSED [  9%]
tests/test_analysis.py::TestNTFSTimestompingRule::test_timestomping_detected PASSED [  9%]
tests/test_analysis.py::TestNTFSTimestompingRule::test_no_timestomping PASSED [  9%]
tests/test_analysis.py::TestNTFSNanosecondTruncationRule::test_nanosecond_truncation_detected PASSED [  9%]
tests/test_analysis.py::TestNTFSNanosecondTruncationRule::test_no_nanosecond_truncation PASSED [ 10%]
tests/test_analysis.py::TestNTFSImpossibleTimestampRule::test_impossible_timestamp_detected PASSED [ 10%]
tests/test_analysis.py::TestNTFSImpossibleTimestampRule::test_no_impossible_timestamps PASSED [ 10%]
tests/test_analysis.py::TestDWGNTFSCreationContradictionRule::test_creation_contradiction_detected PASSED [ 10%]
tests/test_analysis.py::TestDWGNTFSCreationContradictionRule::test_no_creation_contradiction PASSED [ 10%]
tests/test_analysis.py::TestDWGNTFSModificationContradictionRule::test_modification_contradiction_detected PASSED [ 10%]
tests/test_analysis.py::TestDWGNTFSModificationContradictionRule::test_no_modification_contradiction PASSED [ 10%]
tests/test_analysis.py::TestZeroEditTimeRule::test_zero_edit_time_detected PASSED [ 10%]
tests/test_analysis.py::TestZeroEditTimeRule::test_normal_edit_time PASSED [ 10%]
tests/test_analysis.py::TestImplausibleEditRatioRule::test_implausible_ratio_detected PASSED [ 10%]
tests/test_analysis.py::TestImplausibleEditRatioRule::test_plausible_ratio PASSED [ 10%]
tests/test_analysis.py::TestThirdPartyToolRule::test_third_party_tool_detected PASSED [ 10%]
tests/test_analysis.py::TestThirdPartyToolRule::test_autodesk_tool PASSED [ 10%]
tests/test_analysis.py::TestCompoundTimestampAnomalyRule::test_compound_anomaly_detected PASSED [ 11%]
tests/test_analysis.py::TestCompoundTimestampAnomalyRule::test_no_compound_anomalies PASSED [ 11%]
tests/test_analysis.py::TestForensicImpossibilityScoreRule::test_high_impossibility_score PASSED [ 11%]
tests/test_analysis.py::TestForensicImpossibilityScoreRule::test_low_impossibility_score PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_valid_file PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_collects_sha256 PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_legacy_version PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_truly_unsupported_version PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_crc_validation_included PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_risk_assessment_included PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_detects_crc_anomaly PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyze_detects_tampering_indicator PASSED [ 11%]
tests/test_analyzer.py::TestForensicAnalyzer::test_high_risk_for_crc_mismatch PASSED [ 12%]
tests/test_analyzer.py::TestForensicAnalyzer::test_low_risk_for_valid_file PASSED [ 12%]
tests/test_analyzer.py::TestForensicAnalyzer::test_analyzer_version_set PASSED [ 12%]
tests/test_analyzer.py::TestAnalyzeFileFunction::test_analyze_file_returns_analysis PASSED [ 12%]
tests/test_analyzer.py::TestAnalyzeFileFunction::test_analyze_file_same_as_analyzer PASSED [ 12%]
tests/test_analyzer.py::TestAnalyzerWithCustomRules::test_init_with_custom_rules_path PASSED [ 12%]
tests/test_analyzer.py::TestBuildMetadataFromTimestamps::test_metadata_with_overflow_tdcreate PASSED [ 12%]
tests/test_analyzer.py::TestBuildMetadataFromTimestamps::test_metadata_with_overflow_tdupdate PASSED [ 12%]
tests/test_analyzer.py::TestAdvancedTamperingIndicators::test_detect_tdindwg_manipulation PASSED [ 12%]
tests/test_analyzer.py::TestAdvancedTamperingIndicators::test_detect_timezone_manipulation PASSED [ 12%]
tests/test_analyzer.py::TestAdvancedTamperingIndicators::test_detect_educational_watermark PASSED [ 12%]
tests/test_analyzer.py::TestRuleIdToIndicatorTypeMapping::test_tamper_013_maps_to_tdindwg PASSED [ 12%]
tests/test_analyzer.py::TestRuleIdToIndicatorTypeMapping::test_tamper_014_maps_to_version_anachronism PASSED [ 12%]
tests/test_analyzer.py::TestRuleIdToIndicatorTypeMapping::test_tamper_015_maps_to_timezone PASSED [ 13%]
tests/test_analyzer.py::TestRuleIdToIndicatorTypeMapping::test_tamper_016_maps_to_educational PASSED [ 13%]
tests/test_analyzer.py::TestAnalyzeTamperingFunction::test_analyze_tampering_returns_report PASSED [ 13%]
tests/test_analyzer.py::TestAnalyzeTamperingFunction::test_analyze_tampering_with_custom_rules PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_info_exists PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_warning_exists PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_error_exists PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_critical_exists PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_security_exists PASSED [ 13%]
tests/test_audit.py::TestAuditLevel::test_audit_level_values PASSED      [ 13%]
tests/test_audit.py::TestAuditLoggerInitialization::test_init_creates_instance PASSED [ 13%]
tests/test_audit.py::TestAuditLoggerInitialization::test_init_with_string_path PASSED [ 13%]
tests/test_audit.py::TestAuditLoggerInitialization::test_init_creates_log_dir_if_missing PASSED [ 13%]
tests/test_audit.py::TestAuditLoggerInitialization::test_init_creates_log_files PASSED [ 14%]
tests/test_audit.py::TestLogMethod::test_log_info PASSED                 [ 14%]
tests/test_audit.py::TestLogMethod::test_log_warning PASSED              [ 14%]
tests/test_audit.py::TestLogMethod::test_log_error PASSED                [ 14%]
tests/test_audit.py::TestLogMethod::test_log_critical PASSED             [ 14%]
tests/test_audit.py::TestLogMethod::test_log_security PASSED             [ 14%]
tests/test_audit.py::TestLogMethod::test_log_with_extra_data PASSED      [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_intake PASSED      [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_access PASSED      [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_analysis PASSED    [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_export PASSED      [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_verification PASSED [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_error_method PASSED [ 14%]
tests/test_audit.py::TestSpecializedLogging::test_log_security_method PASSED [ 15%]
tests/test_audit.py::TestAuditTrailRetrieval::test_get_audit_trail_returns_list PASSED [ 15%]
tests/test_audit.py::TestAuditTrailRetrieval::test_get_audit_trail_contains_logged_entries PASSED [ 15%]
tests/test_audit.py::TestAuditTrailRetrieval::test_get_audit_trail_filter_by_level PASSED [ 15%]
tests/test_audit.py::TestAuditTrailExport::test_export_audit_trail_creates_file PASSED [ 15%]
tests/test_audit.py::TestAuditTrailExport::test_export_audit_trail_valid_json PASSED [ 15%]
tests/test_audit.py::TestSingletonPattern::test_get_audit_logger_returns_instance PASSED [ 15%]
tests/test_audit.py::TestSingletonPattern::test_get_audit_logger_returns_same_instance PASSED [ 15%]
tests/test_audit.py::TestJsonLinesFormat::test_jsonl_file_created PASSED [ 15%]
tests/test_audit.py::TestJsonLinesFormat::test_jsonl_entries_valid PASSED [ 15%]
tests/test_audit.py::TestThreadSafety::test_concurrent_logging PASSED    [ 15%]
tests/test_audit.py::TestLogEntryContent::test_log_entry_contains_timestamp PASSED [ 15%]
tests/test_audit.py::TestLogEntryContent::test_log_entry_contains_level PASSED [ 16%]
tests/test_audit.py::TestLogEntryContent::test_log_entry_contains_action PASSED [ 16%]
tests/test_audit.py::TestErrorHandling::test_log_empty_action PASSED     [ 16%]
tests/test_audit.py::TestErrorHandling::test_log_unicode_message PASSED  [ 16%]
tests/test_audit.py::TestIntegration::test_full_audit_workflow PASSED    [ 16%]
tests/test_audit.py::TestIntegration::test_audit_logger_with_evidence_lifecycle PASSED [ 16%]
tests/test_audit.py::TestAuditLoggerContextManager::test_context_manager_enter_exit PASSED [ 16%]
tests/test_audit.py::TestAuditLoggerContextManager::test_close_method_releases_handlers PASSED [ 16%]
tests/test_audit.py::TestGetAuditTrailFiltering::test_get_audit_trail_filter_by_evidence_id PASSED [ 16%]
tests/test_audit.py::TestGetAuditTrailFiltering::test_get_audit_trail_filter_by_case_id PASSED [ 16%]
tests/test_audit.py::TestGetAuditTrailFiltering::test_get_audit_trail_filter_by_date_range PASSED [ 16%]
tests/test_audit.py::TestGetAuditTrailFiltering::test_get_audit_trail_empty_log_file PASSED [ 16%]
tests/test_audit.py::TestGetAuditTrailFiltering::test_get_audit_trail_handles_malformed_json PASSED [ 16%]
tests/test_audit.py::TestAuditTrailExportFormats::test_export_csv_format PASSED [ 17%]
tests/test_audit.py::TestAuditTrailExportFormats::test_export_csv_empty_entries PASSED [ 17%]
tests/test_audit.py::TestAuditTrailExportFormats::test_export_txt_format PASSED [ 17%]
tests/test_audit.py::TestAuditTrailExportFormats::test_export_unsupported_format_raises PASSED [ 17%]
tests/test_audit.py::TestGetSystemInfoException::test_get_system_info_socket_error PASSED [ 17%]
tests/test_audit.py::TestGlobalAuditLogger::test_get_audit_logger_with_default_dir PASSED [ 17%]
tests/test_audit.py::TestLogWithDetails::test_log_with_details_dict PASSED [ 17%]
tests/test_audit.py::TestLogAnalysisWithoutFindings::test_log_analysis_without_findings PASSED [ 17%]
tests/test_audit.py::TestLogVerificationFailed::test_log_verification_failed PASSED [ 17%]
tests/test_cad_fingerprinting.py::TestCADApplication::test_autocad_value PASSED [ 17%]
tests/test_cad_fingerprinting.py::TestCADApplication::test_all_applications_defined PASSED [ 17%]
tests/test_cad_fingerprinting.py::TestCADApplication::test_enum_is_str_subclass PASSED [ 17%]
tests/test_cad_fingerprinting.py::TestCADSignature::test_create_signature_with_all_fields PASSED [ 17%]
tests/test_cad_fingerprinting.py::TestCADSignature::test_create_signature_with_defaults PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADSignature::test_signature_with_bytes_pattern PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestFingerprintResult::test_create_result_minimal PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestFingerprintResult::test_create_result_full PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterInit::test_init_loads_signatures PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterInit::test_init_has_crc_signatures PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterInit::test_init_has_string_signatures PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterInit::test_oda_based_apps_defined PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterInit::test_open_source_apps_defined PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterCRCSignatures::test_zero_crc_detected PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterCRCSignatures::test_non_zero_crc_no_match PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_bricscad PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_nanocad PASSED [ 18%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_draftsight PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_qcad PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_librecad PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_oda_sdk PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_detect_teigha PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_case_insensitive_detection PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterStringSignatures::test_no_match_for_clean_file PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterMetadataSignatures::test_detect_from_lastsavedby PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterMetadataSignatures::test_detect_from_author PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterMetadataSignatures::test_no_match_empty_metadata PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterMetadataSignatures::test_no_match_non_string_values PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_tdcreate_equals_tdupdate PASSED [ 19%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_zero_tdindwg PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_zero_timestamps PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_missing_fingerprintguid PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_missing_versionguid PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_detect_cyrillic_codepage PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_no_anomalies_for_valid_metadata PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterTimestampAnomalies::test_uppercase_metadata_keys PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_detect_oda_class_prefix PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_detect_bricscad_marker PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_clean_file_no_oda PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_file_not_found PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_detect_teigha_marker PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterODADetection::test_detect_multiple_markers PASSED [ 20%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterDetermineApplication::test_no_signatures_returns_unknown PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterDetermineApplication::test_single_signature_match PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterDetermineApplication::test_multiple_signatures_same_app PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterDetermineApplication::test_oda_sdk_signature_marks_oda_based PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterFingerprint::test_fingerprint_bricscad PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterFingerprint::test_fingerprint_with_zero_crc PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterFingerprint::test_fingerprint_with_metadata PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterFingerprint::test_fingerprint_nonexistent_file PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterFingerprint::test_fingerprint_crc_evidence PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterForensicReport::test_report_for_bricscad PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterForensicReport::test_report_for_autocad PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterForensicReport::test_report_with_no_signatures PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestCADFingerprinterForensicReport::test_report_contains_headers PASSED [ 21%]
tests/test_cad_fingerprinting.py::TestFingerprintDWGFunction::test_function_returns_result PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestFingerprintDWGFunction::test_function_with_all_params PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestFingerprintDWGFunction::test_function_with_path_object PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingIntegration::test_full_workflow PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingIntegration::test_timestamp_anomalies_workflow PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingEdgeCases::test_empty_file PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingEdgeCases::test_binary_patterns_in_string_search PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingEdgeCases::test_unicode_in_metadata PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingEdgeCases::test_very_large_confidence_accumulation PASSED [ 22%]
tests/test_cad_fingerprinting.py::TestCADFingerprintingEdgeCases::test_mixed_application_signatures PASSED [ 22%]
tests/test_cli.py::TestCLIBasic::test_cli_version PASSED                 [ 22%]
tests/test_cli.py::TestCLIBasic::test_cli_help PASSED                    [ 22%]
tests/test_cli.py::TestCLIBasic::test_cli_info_command PASSED            [ 22%]
tests/test_cli.py::TestCLIBasic::test_print_status_function PASSED       [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_valid_file PASSED    [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_json_output PASSED   [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_legacy_version PASSED [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_truly_unsupported_version PASSED [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_nonexistent_file PASSED [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_with_output_file PASSED [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_verbose_mode PASSED  [ 23%]
tests/test_cli.py::TestAnalyzeCommand::test_analyze_verbose_with_error PASSED [ 23%]
tests/test_cli.py::TestValidateCRCCommand::test_validate_crc_valid PASSED [ 23%]
tests/test_cli.py::TestValidateCRCCommand::test_validate_crc_invalid PASSED [ 23%]
tests/test_cli.py::TestMetadataCommand::test_metadata_table_output PASSED [ 23%]
tests/test_cli.py::TestMetadataCommand::test_metadata_json_output PASSED [ 24%]
tests/test_cli.py::TestMetadataCommand::test_metadata_unsupported_version PASSED [ 24%]
tests/test_cli.py::TestTamperingCommand::test_tampering_table_output PASSED [ 24%]
tests/test_cli.py::TestTamperingCommand::test_tampering_json_output PASSED [ 24%]
tests/test_cli.py::TestTamperingCommand::test_tampering_with_output_file PASSED [ 24%]
tests/test_cli.py::TestTamperingCommand::test_tampering_verbose_mode PASSED [ 24%]
tests/test_cli.py::TestListRulesCommand::test_list_rules_table PASSED    [ 24%]
tests/test_cli.py::TestListRulesCommand::test_list_rules_json PASSED     [ 24%]
tests/test_cli.py::TestCompareCommand::test_compare_two_files PASSED     [ 24%]
tests/test_cli.py::TestBatchCommand::test_batch_directory PASSED         [ 24%]
tests/test_cli.py::TestBatchCommand::test_batch_recursive PASSED         [ 24%]
tests/test_cli.py::TestProtectCommand::test_protect_file PASSED          [ 24%]
tests/test_cli.py::TestProtectCommand::test_protect_already_protected PASSED [ 24%]
tests/test_cli.py::TestCheckProtectionCommand::test_check_protection_unprotected PASSED [ 25%]
tests/test_cli.py::TestIntakeCommand::test_intake_help PASSED            [ 25%]
tests/test_cli.py::TestIntakeCommand::test_intake_missing_args PASSED    [ 25%]
tests/test_cli.py::TestVerifyCommand::test_verify_help PASSED            [ 25%]
tests/test_cli.py::TestCustodyChainCommand::test_custody_chain_help PASSED [ 25%]
tests/test_cli.py::TestLogEventCommand::test_log_event_help PASSED       [ 25%]
tests/test_cli.py::TestAnalyzeExceptionHandling::test_analyze_generic_exception_verbose PASSED [ 25%]
tests/test_cli.py::TestAnalyzeExceptionHandling::test_analyze_dwg_forensic_error PASSED [ 25%]
tests/test_cli.py::TestPrintAnalysisTableBranches::test_print_analysis_table_with_application_origin PASSED [ 25%]
tests/test_cli.py::TestValidateCRCExceptionHandling::test_validate_crc_dwg_forensic_error PASSED [ 25%]
tests/test_cli.py::TestMetadataExceptionHandling::test_metadata_dwg_forensic_error PASSED [ 25%]
tests/test_cli.py::TestIntakeCommandFull::test_intake_full_workflow PASSED [ 25%]
tests/test_cli.py::TestIntakeCommandFull::test_intake_with_evidence_number PASSED [ 25%]
tests/test_cli.py::TestIntakeCommandFull::test_intake_error_handling PASSED [ 26%]
tests/test_cli.py::TestVerifyCommandFull::test_verify_valid_evidence PASSED [ 26%]
tests/test_cli.py::TestVerifyCommandFull::test_verify_invalid_evidence_id PASSED [ 26%]
tests/test_cli.py::TestCustodyChainCommandFull::test_custody_chain_full_workflow PASSED [ 26%]
tests/test_cli.py::TestCustodyChainCommandFull::test_custody_chain_invalid_id PASSED [ 26%]
tests/test_cli.py::TestLogEventCommandFull::test_log_event_full_workflow PASSED [ 26%]
tests/test_cli.py::TestLogEventCommandFull::test_log_event_invalid_evidence PASSED [ 26%]
tests/test_cli.py::TestProtectCommandExceptions::test_protect_permission_error PASSED [ 26%]
tests/test_cli.py::TestProtectCommandExceptions::test_protect_generic_exception PASSED [ 26%]
tests/test_cli.py::TestCheckProtectionBranches::test_check_protection_protected_file PASSED [ 26%]
tests/test_cli.py::TestCheckProtectionBranches::test_check_protection_exception PASSED [ 26%]
tests/test_cli.py::TestTamperingCommandExceptions::test_tampering_dwg_forensic_error PASSED [ 26%]
tests/test_cli.py::TestTamperingCommandExceptions::test_tampering_generic_exception_verbose PASSED [ 27%]
tests/test_cli.py::TestTamperingReportPrinting::test_tampering_report_crc_none PASSED [ 27%]
tests/test_cli.py::TestTamperingReportPrinting::test_tampering_report_with_failed_rules PASSED [ 27%]
tests/test_cli.py::TestTamperingReportPrinting::test_tampering_report_verbose_with_anomalies PASSED [ 27%]
tests/test_cli.py::TestReportCommandExceptions::test_report_unsupported_version PASSED [ 27%]
tests/test_cli.py::TestReportCommandExceptions::test_report_dwg_forensic_error PASSED [ 27%]
tests/test_cli.py::TestReportCommandExceptions::test_report_generic_exception_verbose PASSED [ 27%]
tests/test_cli.py::TestExpertWitnessCommandExceptions::test_expert_witness_unsupported_version PASSED [ 27%]
tests/test_cli.py::TestExpertWitnessCommandExceptions::test_expert_witness_dwg_forensic_error PASSED [ 27%]
tests/test_cli.py::TestExpertWitnessCommandExceptions::test_expert_witness_generic_exception_verbose PASSED [ 27%]
tests/test_cli.py::TestTimelineCommandExceptions::test_timeline_svg_output PASSED [ 27%]
tests/test_cli.py::TestTimelineCommandExceptions::test_timeline_unsupported_version PASSED [ 27%]
tests/test_cli.py::TestTimelineCommandExceptions::test_timeline_dwg_forensic_error PASSED [ 27%]
tests/test_cli.py::TestTimelineCommandExceptions::test_timeline_generic_exception_verbose PASSED [ 28%]
tests/test_cli.py::TestMainEntryPoint::test_main_module_execution PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_empty_input PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_end_marker_only PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_literal_minimum PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_literal_maximum_short PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_literal_multiple_runs PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_backref_short PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_backref_medium PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_backref_long PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_backref_long_extended PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_extended_literal PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_with_expected_size PASSED [ 28%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_size_mismatch_error PASSED [ 29%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_size_mismatch_no_validation PASSED [ 29%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_overlapping_backref PASSED [ 29%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_invalid_backref_offset PASSED [ 29%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_truncated_input PASSED [ 29%]
tests/test_compression.py::TestDWGDecompressor::test_decompress_zero_offset_backref PASSED [ 29%]
tests/test_compression.py::TestPageHeader::test_parse_valid_header PASSED [ 29%]
tests/test_compression.py::TestPageHeader::test_parse_header_with_offset PASSED [ 29%]
tests/test_compression.py::TestPageHeader::test_parse_header_insufficient_data PASSED [ 29%]
tests/test_compression.py::TestDecompressPage::test_decompress_uncompressed_page PASSED [ 29%]
tests/test_compression.py::TestDecompressPage::test_decompress_compressed_page PASSED [ 29%]
tests/test_compression.py::TestConvenienceFunctions::test_decompress_section_simple PASSED [ 29%]
tests/test_compression.py::TestConvenienceFunctions::test_decompress_section_no_validation PASSED [ 29%]
tests/test_compression.py::TestChecksum::test_calculate_checksum_empty PASSED [ 30%]
tests/test_compression.py::TestChecksum::test_calculate_checksum_simple PASSED [ 30%]
tests/test_compression.py::TestChecksum::test_calculate_checksum_overflow PASSED [ 30%]
tests/test_compression.py::TestChecksum::test_verify_checksum_valid PASSED [ 30%]
tests/test_compression.py::TestChecksum::test_verify_checksum_invalid PASSED [ 30%]
tests/test_compression.py::TestRealWorldPatterns::test_repeated_pattern_compression PASSED [ 30%]
tests/test_compression.py::TestRealWorldPatterns::test_mixed_literal_and_backref PASSED [ 30%]
tests/test_crc.py::TestCRCValidator::test_valid_crc PASSED               [ 30%]
tests/test_crc.py::TestCRCValidator::test_invalid_crc PASSED             [ 30%]
tests/test_crc.py::TestCRCValidator::test_crc_hex_format PASSED          [ 30%]
tests/test_crc.py::TestCRCValidator::test_too_small_file PASSED          [ 30%]
tests/test_crc.py::TestCRCValidator::test_nonexistent_file PASSED        [ 30%]
tests/test_crc.py::TestCRCValidator::test_version_crc_info PASSED        [ 31%]
tests/test_crc.py::TestCRCValidator::test_no_crc_versions PASSED         [ 31%]
tests/test_crc.py::TestCRCValidator::test_has_crc_support PASSED         [ 31%]
tests/test_crc.py::TestCRCValidator::test_crc_na_for_old_versions PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_unknown_version_returns_na PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_permission_error PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_os_error PASSED       [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_detect_version_file_too_small PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_detect_version_unicode_error PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_read_stored_crc_insufficient_bytes PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_calculate_header_crc_insufficient_bytes PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_has_crc_support_unknown_version PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_ac1009_no_crc_support PASSED [ 31%]
tests/test_crc.py::TestCRCValidatorEdgeCases::test_ac1006_no_crc_support PASSED [ 32%]
tests/test_custody.py::TestEventType::test_event_type_values_exist PASSED [ 32%]
tests/test_custody.py::TestEventType::test_event_type_string_values PASSED [ 32%]
tests/test_custody.py::TestCustodyChainInitialization::test_init_creates_instance PASSED [ 32%]
tests/test_custody.py::TestCustodyChainInitialization::test_init_creates_database PASSED [ 32%]
tests/test_custody.py::TestEventLogging::test_log_event_creates_record PASSED [ 32%]
tests/test_custody.py::TestEventLogging::test_log_event_with_notes PASSED [ 32%]
tests/test_custody.py::TestEventLogging::test_log_event_sets_timestamp PASSED [ 32%]
tests/test_custody.py::TestEventLogging::test_log_event_records_workstation PASSED [ 32%]
tests/test_custody.py::TestEventLogging::test_log_event_invalid_evidence_raises_error PASSED [ 32%]
tests/test_custody.py::TestChainRetrieval::test_get_chain_returns_events PASSED [ 32%]
tests/test_custody.py::TestChainRetrieval::test_get_chain_empty_for_invalid_id PASSED [ 32%]
tests/test_custody.py::TestEvidenceRetrieval::test_get_evidence_returns_record PASSED [ 32%]
tests/test_custody.py::TestEvidenceRetrieval::test_get_evidence_nonexistent_returns_none PASSED [ 33%]
tests/test_custody.py::TestIntegrityVerification::test_verify_integrity_valid_file PASSED [ 33%]
tests/test_custody.py::TestIntegrityVerification::test_verify_integrity_nonexistent_evidence PASSED [ 33%]
tests/test_custody.py::TestCustodyReportGeneration::test_generate_custody_report_returns_dict PASSED [ 33%]
tests/test_custody.py::TestCustodyReportGeneration::test_generate_custody_report_contains_evidence_info PASSED [ 33%]
tests/test_custody.py::TestCustodyReportGeneration::test_generate_custody_report_nonexistent_raises_error PASSED [ 33%]
tests/test_custody.py::TestIntegrityError::test_integrity_error_is_exception PASSED [ 33%]
tests/test_custody.py::TestIntegrityError::test_integrity_error_can_be_raised PASSED [ 33%]
tests/test_custody.py::TestIntegrityError::test_integrity_error_message PASSED [ 33%]
tests/test_custody.py::TestIntegration::test_full_custody_lifecycle PASSED [ 33%]
tests/test_custody.py::TestGetEvidenceByHash::test_get_evidence_by_hash_found PASSED [ 33%]
tests/test_custody.py::TestGetEvidenceByHash::test_get_evidence_by_hash_not_found PASSED [ 33%]
tests/test_custody.py::TestSearchEvidence::test_search_evidence_by_case_id PASSED [ 33%]
tests/test_custody.py::TestSearchEvidence::test_search_evidence_by_filename PASSED [ 34%]
tests/test_custody.py::TestSearchEvidence::test_search_evidence_by_examiner PASSED [ 34%]
tests/test_custody.py::TestSearchEvidence::test_search_evidence_no_results PASSED [ 34%]
tests/test_custody.py::TestIntegrityVerificationAdvanced::test_verify_integrity_file_not_on_disk PASSED [ 34%]
tests/test_custody.py::TestIntegrityVerificationAdvanced::test_verify_integrity_hash_mismatch PASSED [ 34%]
tests/test_custody.py::TestLogEventIntegrityError::test_log_event_raises_integrity_error_when_hash_fails PASSED [ 34%]
tests/test_custody.py::TestLogEventIntegrityError::test_log_event_without_hash_verification PASSED [ 34%]
tests/test_custody.py::TestContextManager::test_custody_chain_context_manager PASSED [ 34%]
tests/test_custody.py::TestContextManager::test_custody_chain_close_method PASSED [ 34%]
tests/test_custody.py::TestCustodyReportWithVerification::test_report_last_verified_found PASSED [ 34%]
tests/test_database.py::TestEngineCreation::test_get_engine_memory PASSED [ 34%]
tests/test_database.py::TestEngineCreation::test_get_engine_file PASSED  [ 34%]
tests/test_database.py::TestDatabaseInitialization::test_init_db_creates_tables PASSED [ 35%]
tests/test_database.py::TestDatabaseInitialization::test_init_db_idempotent PASSED [ 35%]
tests/test_database.py::TestSessionManagement::test_get_session_returns_session PASSED [ 35%]
tests/test_database.py::TestSessionManagement::test_session_can_query PASSED [ 35%]
tests/test_database.py::TestCaseInfoModel::test_create_case_minimal PASSED [ 35%]
tests/test_database.py::TestCaseInfoModel::test_create_case_full PASSED  [ 35%]
tests/test_database.py::TestCaseInfoModel::test_case_default_values PASSED [ 35%]
tests/test_database.py::TestCaseInfoModel::test_case_relationship_evidence_files PASSED [ 35%]
tests/test_database.py::TestEvidenceFileModel::test_create_evidence_minimal PASSED [ 35%]
tests/test_database.py::TestEvidenceFileModel::test_evidence_uuid_generation PASSED [ 35%]
tests/test_database.py::TestEvidenceFileModel::test_evidence_relationship_custody_events PASSED [ 35%]
tests/test_database.py::TestCustodyEventModel::test_create_custody_event_minimal PASSED [ 35%]
tests/test_database.py::TestCustodyEventModel::test_create_custody_event_full PASSED [ 35%]
tests/test_database.py::TestCustodyEventModel::test_custody_event_timestamp PASSED [ 36%]
tests/test_database.py::TestRelationshipsAndCascades::test_case_to_evidence_relationship PASSED [ 36%]
tests/test_database.py::TestRelationshipsAndCascades::test_multiple_evidence_per_case PASSED [ 36%]
tests/test_database.py::TestQueryAndFilter::test_query_cases_by_status PASSED [ 36%]
tests/test_database.py::TestQueryAndFilter::test_query_evidence_by_case PASSED [ 36%]
tests/test_database.py::TestEdgeCases::test_long_text_fields PASSED      [ 36%]
tests/test_database.py::TestEdgeCases::test_special_characters_in_paths PASSED [ 36%]
tests/test_diagnostics.py::test_parse_diagnostics_creation PASSED        [ 36%]
tests/test_diagnostics.py::test_parse_diagnostics_methods PASSED         [ 36%]
tests/test_diagnostics.py::test_parse_diagnostics_to_dict PASSED         [ 36%]
tests/test_diagnostics.py::test_drawing_variables_result_includes_diagnostics PASSED [ 36%]
tests/test_diagnostics.py::test_section_map_result_includes_tried_offsets PASSED [ 36%]
tests/test_drawing_vars.py::TestDWGVariableType::test_variable_types_defined PASSED [ 36%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_creation PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_defaults PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_with_datetime PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_with_error PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_to_dict PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingTimestamp::test_timestamp_to_dict_no_datetime PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingGUID::test_guid_creation PASSED   [ 37%]
tests/test_drawing_vars.py::TestDrawingGUID::test_guid_defaults PASSED   [ 37%]
tests/test_drawing_vars.py::TestDrawingGUID::test_guid_with_raw_bytes PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingGUID::test_guid_to_dict PASSED    [ 37%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_empty_result PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_has_timestamps_true PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_has_timestamps_false PASSED [ 37%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_has_timestamps_invalid PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_get_creation_time PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_get_creation_time_none PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_get_modification_time PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_get_total_edit_time PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_get_total_edit_time_zero PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesResult::test_result_to_dict PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParser::test_parser_initialization PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParser::test_parser_guid_size PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParser::test_parser_julian_date_size PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParserFileAccess::test_file_not_found PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParserFileAccess::test_file_too_small PASSED [ 38%]
tests/test_drawing_vars.py::TestDrawingVariablesParserFileAccess::test_invalid_version_string PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_parse_ac1018_version PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_parse_ac1021_version PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_parse_ac1024_version PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_parse_ac1027_version PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_parse_ac1032_version PASSED [ 39%]
tests/test_drawing_vars.py::TestDrawingVariablesParserVersions::test_unsupported_version PASSED [ 39%]
tests/test_drawing_vars.py::TestJulianDateConversion::test_julian_to_datetime_valid PASSED [ 39%]
tests/test_drawing_vars.py::TestJulianDateConversion::test_julian_to_datetime_with_fraction PASSED [ 39%]
tests/test_drawing_vars.py::TestJulianDateConversion::test_julian_to_datetime_invalid_range PASSED [ 39%]
tests/test_drawing_vars.py::TestJulianDateConversion::test_julian_to_datetime_future PASSED [ 39%]
tests/test_drawing_vars.py::TestGUIDConversion::test_bytes_to_guid_string_valid PASSED [ 39%]
tests/test_drawing_vars.py::TestGUIDConversion::test_bytes_to_guid_string_wrong_length PASSED [ 39%]
tests/test_drawing_vars.py::TestGUIDConversion::test_bytes_to_guid_string_format PASSED [ 40%]
tests/test_drawing_vars.py::TestTimestampScanning::test_scan_finds_valid_timestamp PASSED [ 40%]
tests/test_drawing_vars.py::TestGUIDScanning::test_scan_finds_uuid_v4 PASSED [ 40%]
tests/test_drawing_vars.py::TestExtractHeaderInfo::test_extract_maintenance_version PASSED [ 40%]
tests/test_drawing_vars.py::TestExtractHeaderInfo::test_extract_codepage PASSED [ 40%]
tests/test_drawing_vars.py::TestExtractDrawingVariablesConvenience::test_extract_drawing_variables_returns_result PASSED [ 40%]
tests/test_drawing_vars.py::TestExtractDrawingVariablesConvenience::test_extract_drawing_variables_invalid_file PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_matching_timestamps PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_mismatched_creation PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_mismatched_modification PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_creation_after_modification PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_future_creation PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_future_modification PASSED [ 40%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_with_none_values PASSED [ 41%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_partial_none_values PASSED [ 41%]
tests/test_drawing_vars.py::TestCompareTimestamps::test_compare_diff_seconds_calculated PASSED [ 41%]
tests/test_drawing_vars.py::TestForensicScenarios::test_timestomping_detection PASSED [ 41%]
tests/test_drawing_vars.py::TestForensicScenarios::test_backdated_file_detection PASSED [ 41%]
tests/test_drawing_vars.py::TestVersionCoverageDrawingVars::test_ac1018_supported PASSED [ 41%]
tests/test_drawing_vars.py::TestVersionCoverageDrawingVars::test_ac1021_supported PASSED [ 41%]
tests/test_drawing_vars.py::TestVersionCoverageDrawingVars::test_ac1024_supported PASSED [ 41%]
tests/test_drawing_vars.py::TestVersionCoverageDrawingVars::test_ac1027_supported PASSED [ 41%]
tests/test_drawing_vars.py::TestVersionCoverageDrawingVars::test_ac1032_supported PASSED [ 41%]
tests/test_encryption.py::TestVersionDetection::test_get_version_ac1032 PASSED [ 41%]
tests/test_encryption.py::TestVersionDetection::test_get_version_ac1027 PASSED [ 41%]
tests/test_encryption.py::TestVersionDetection::test_get_version_ac1024 PASSED [ 41%]
tests/test_encryption.py::TestVersionDetection::test_get_version_ac1021 PASSED [ 42%]
tests/test_encryption.py::TestVersionDetection::test_get_version_ac1018 PASSED [ 42%]
tests/test_encryption.py::TestVersionDetection::test_get_version_short_data PASSED [ 42%]
tests/test_encryption.py::TestVersionDetection::test_get_version_empty PASSED [ 42%]
tests/test_encryption.py::TestVersionDetection::test_get_version_with_nulls PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_is_encrypted_ac1032 PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_is_encrypted_ac1021 PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_not_encrypted_ac1024 PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_not_encrypted_ac1027 PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_not_encrypted_ac1018 PASSED [ 42%]
tests/test_encryption.py::TestEncryptionDetection::test_short_data_not_encrypted PASSED [ 42%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_identity PASSED [ 42%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_modifies_encrypted_region PASSED [ 43%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_preserves_header PASSED [ 43%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_preserves_tail PASSED [ 43%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_too_small_raises PASSED [ 43%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_in_place PASSED [ 43%]
tests/test_encryption.py::TestAC1032Decryption::test_decrypt_in_place_requires_bytearray PASSED [ 43%]
tests/test_encryption.py::TestAC1021Decryption::test_decrypt_ac1021 PASSED [ 43%]
tests/test_encryption.py::TestAC1021Decryption::test_decrypt_ac1021_too_small PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_ac1032_offset PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_ac1027_offset PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_ac1024_offset PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_ac1021_offset PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_ac1018_offset PASSED [ 43%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_unknown_version_offset PASSED [ 44%]
tests/test_encryption.py::TestSectionLocatorOffsets::test_section_map_address_offset PASSED [ 44%]
tests/test_encryption.py::TestPrepareFileData::test_prepare_ac1032 PASSED [ 44%]
tests/test_encryption.py::TestPrepareFileData::test_prepare_ac1024 PASSED [ 44%]
tests/test_encryption.py::TestPrepareFileData::test_prepare_preserves_data PASSED [ 44%]
tests/test_encryption.py::TestMaskProperties::test_mask_length PASSED    [ 44%]
tests/test_encryption.py::TestMaskProperties::test_encrypted_region_size PASSED [ 44%]
tests/test_encryption.py::TestMaskProperties::test_mask_is_non_trivial PASSED [ 44%]
tests/test_encryption.py::TestMaskProperties::test_mask_not_all_same PASSED [ 44%]
tests/test_exceptions.py::TestDWGForensicError::test_basic_error PASSED  [ 44%]
tests/test_exceptions.py::TestDWGForensicError::test_error_with_details PASSED [ 44%]
tests/test_exceptions.py::TestUnsupportedVersionError::test_basic_unsupported_version PASSED [ 44%]
tests/test_exceptions.py::TestUnsupportedVersionError::test_with_version_name PASSED [ 44%]
tests/test_exceptions.py::TestUnsupportedVersionError::test_with_file_path PASSED [ 45%]
tests/test_exceptions.py::TestInvalidDWGError::test_basic_invalid_error PASSED [ 45%]
tests/test_exceptions.py::TestInvalidDWGError::test_with_reason PASSED   [ 45%]
tests/test_exceptions.py::TestInvalidDWGError::test_with_magic_bytes PASSED [ 45%]
tests/test_exceptions.py::TestCRCMismatchError::test_basic_crc_error PASSED [ 45%]
tests/test_exceptions.py::TestCRCMismatchError::test_with_file_path_and_offset PASSED [ 45%]
tests/test_exceptions.py::TestParseError::test_basic_parse_error PASSED  [ 45%]
tests/test_exceptions.py::TestParseError::test_with_section PASSED       [ 45%]
tests/test_exceptions.py::TestParseError::test_with_cause PASSED         [ 45%]
tests/test_exceptions.py::TestIntakeError::test_basic_intake_error PASSED [ 45%]
tests/test_exceptions.py::TestIntakeError::test_with_reason_and_cause PASSED [ 45%]
tests/test_exceptions.py::TestExceptionHierarchy::test_all_inherit_from_base PASSED [ 45%]
tests/test_exceptions.py::TestExceptionHierarchy::test_can_catch_with_base_class PASSED [ 45%]
tests/test_file_guard.py::TestFileGuardInitialization::test_init_creates_instance PASSED [ 46%]
tests/test_file_guard.py::TestFileGuardInitialization::test_init_detects_windows PASSED [ 46%]
tests/test_file_guard.py::TestFileProtection::test_protect_makes_file_read_only PASSED [ 46%]
tests/test_file_guard.py::TestFileProtection::test_protect_with_path_object PASSED [ 46%]
tests/test_file_guard.py::TestFileProtection::test_protect_nonexistent_file_raises_error PASSED [ 46%]
tests/test_file_guard.py::TestFileUnprotection::test_unprotect_restores_write_permission PASSED [ 46%]
tests/test_file_guard.py::TestFileUnprotection::test_unprotect_nonexistent_file_raises_error PASSED [ 46%]
tests/test_file_guard.py::TestProtectionStatusChecking::test_is_protected_on_protected_file PASSED [ 46%]
tests/test_file_guard.py::TestProtectionStatusChecking::test_is_protected_on_writable_file PASSED [ 46%]
tests/test_file_guard.py::TestProtectionStatusChecking::test_verify_protection_on_protected_file PASSED [ 46%]
tests/test_file_guard.py::TestProtectionStatusChecking::test_verify_protection_on_writable_file PASSED [ 46%]
tests/test_file_guard.py::TestFileAttributes::test_get_file_attributes_returns_complete_dict PASSED [ 46%]
tests/test_file_guard.py::TestFileAttributes::test_get_file_attributes_protected_file PASSED [ 47%]
tests/test_file_guard.py::TestFileAttributes::test_get_file_attributes_nonexistent_file PASSED [ 47%]
tests/test_file_guard.py::TestIntegritySnapshot::test_create_integrity_snapshot_returns_complete_dict PASSED [ 47%]
tests/test_file_guard.py::TestIntegritySnapshot::test_create_integrity_snapshot_calculates_correct_hashes PASSED [ 47%]
tests/test_file_guard.py::TestIntegritySnapshot::test_compare_snapshots_identical_files PASSED [ 47%]
tests/test_file_guard.py::TestIntegritySnapshot::test_compare_snapshots_detects_content_change PASSED [ 47%]
tests/test_file_guard.py::TestIntegritySnapshot::test_compare_snapshots_detects_protection_change PASSED [ 47%]
tests/test_file_guard.py::TestProtectedFileContext::test_context_manager_temporarily_unprotects PASSED [ 47%]
tests/test_file_guard.py::TestProtectedFileContext::test_context_manager_restores_on_exception PASSED [ 47%]
tests/test_file_guard.py::TestProtectedFileContext::test_context_manager_handles_initially_unprotected_file PASSED [ 47%]
tests/test_file_guard.py::TestErrorHandling::test_protect_already_protected_file PASSED [ 47%]
tests/test_file_guard.py::TestIntegration::test_full_protection_cycle PASSED [ 47%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_is_protected_nonexistent_file_returns_false PASSED [ 47%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_verify_protection_nonexistent_file PASSED [ 48%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_protect_os_error PASSED [ 48%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_unprotect_os_error PASSED [ 48%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_create_integrity_snapshot_nonexistent_file PASSED [ 48%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_get_file_attributes_includes_owner PASSED [ 48%]
tests/test_file_guard.py::TestFileGuardEdgeCases::test_get_file_attributes_hidden_file PASSED [ 48%]
tests/test_file_guard.py::TestProtectedFileContextEdgeCases::test_context_manager_returns_path PASSED [ 48%]
tests/test_file_guard.py::TestProtectedFileContextEdgeCases::test_context_manager_exception_during_reprotect PASSED [ 48%]
tests/test_file_guard.py::TestProtectedFileContextEdgeCases::test_context_manager_file_not_initially_protected PASSED [ 48%]
tests/test_file_guard.py::TestCompareSnapshotsSizeChange::test_compare_snapshots_detects_size_change PASSED [ 48%]
tests/test_full_integration.py::TestFullIntegrationWorkflows::test_full_analysis_ac1024 PASSED [ 48%]
tests/test_full_integration.py::TestFullIntegrationWorkflows::test_full_analysis_ac1027 PASSED [ 48%]
tests/test_full_integration.py::TestFullIntegrationWorkflows::test_full_analysis_ac1032 PASSED [ 48%]
tests/test_full_integration.py::TestFullIntegrationWorkflows::test_tampering_detection_with_new_parsers PASSED [ 49%]
tests/test_full_integration.py::TestFullIntegrationWorkflows::test_report_generation_accuracy PASSED [ 49%]
tests/test_handles.py::TestHandleTypeEnum::test_handle_type_values PASSED [ 49%]
tests/test_handles.py::TestObjectTypeEnum::test_entity_types PASSED      [ 49%]
tests/test_handles.py::TestObjectTypeEnum::test_non_entity_types PASSED  [ 49%]
tests/test_handles.py::TestHandleInfo::test_handle_info_creation PASSED  [ 49%]
tests/test_handles.py::TestHandleInfo::test_handle_info_with_all_fields PASSED [ 49%]
tests/test_handles.py::TestHandleGap::test_gap_creation PASSED           [ 49%]
tests/test_handles.py::TestHandleGap::test_gap_with_context PASSED       [ 49%]
tests/test_handles.py::TestHandleGap::test_gap_to_dict PASSED            [ 49%]
tests/test_handles.py::TestHandleStatistics::test_statistics_defaults PASSED [ 49%]
tests/test_handles.py::TestHandleStatistics::test_gap_ratio_zero_expected PASSED [ 49%]
tests/test_handles.py::TestHandleStatistics::test_gap_ratio_calculation PASSED [ 50%]
tests/test_handles.py::TestHandleStatistics::test_statistics_to_dict PASSED [ 50%]
tests/test_handles.py::TestHandleMapResult::test_empty_result PASSED     [ 50%]
tests/test_handles.py::TestHandleMapResult::test_has_gaps_true PASSED    [ 50%]
tests/test_handles.py::TestHandleMapResult::test_has_gaps_false PASSED   [ 50%]
tests/test_handles.py::TestHandleMapResult::test_has_significant_gaps_true PASSED [ 50%]
tests/test_handles.py::TestHandleMapResult::test_has_significant_gaps_false PASSED [ 50%]
tests/test_handles.py::TestHandleMapResult::test_get_critical_gaps PASSED [ 50%]
tests/test_handles.py::TestHandleMapResult::test_get_forensic_summary PASSED [ 50%]
tests/test_handles.py::TestHandleMapResult::test_to_dict PASSED          [ 50%]
tests/test_handles.py::TestHandleMapParser::test_parser_initialization PASSED [ 50%]
tests/test_handles.py::TestHandleMapParser::test_parser_min_file_size PASSED [ 50%]
tests/test_handles.py::TestHandleMapParserFileAccess::test_file_not_found PASSED [ 50%]
tests/test_handles.py::TestHandleMapParserFileAccess::test_file_too_small PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserFileAccess::test_invalid_version_string PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserVersions::test_ac1018_supported PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserVersions::test_ac1021_supported PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserVersions::test_ac1024_supported PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserVersions::test_ac1032_supported PASSED [ 51%]
tests/test_handles.py::TestHandleMapParserVersions::test_unsupported_version PASSED [ 51%]
tests/test_handles.py::TestHandleHeuristics::test_is_likely_handle_valid PASSED [ 51%]
tests/test_handles.py::TestHandleHeuristics::test_is_likely_handle_rejects_power_of_two PASSED [ 51%]
tests/test_handles.py::TestHandleHeuristics::test_is_likely_handle_rejects_common_values PASSED [ 51%]
tests/test_handles.py::TestHandleHeuristics::test_is_likely_handle_rejects_trailing_zeros PASSED [ 51%]
tests/test_handles.py::TestGapAnalysis::test_analyze_gaps_finds_gap PASSED [ 51%]
tests/test_handles.py::TestGapAnalysis::test_analyze_gaps_no_gaps PASSED [ 51%]
tests/test_handles.py::TestGapAnalysis::test_analyze_gaps_multiple PASSED [ 52%]
tests/test_handles.py::TestGapAnalysis::test_analyze_gaps_empty_handles PASSED [ 52%]
tests/test_handles.py::TestGapAnalysis::test_analyze_gaps_single_handle PASSED [ 52%]
tests/test_handles.py::TestGapSeverityClassification::test_critical_severity_large_gap PASSED [ 52%]
tests/test_handles.py::TestGapSeverityClassification::test_high_severity_medium_gap PASSED [ 52%]
tests/test_handles.py::TestGapSeverityClassification::test_medium_severity_small_gap PASSED [ 52%]
tests/test_handles.py::TestGapSeverityClassification::test_low_severity_tiny_gap PASSED [ 52%]
tests/test_handles.py::TestStatisticsCalculation::test_calculate_statistics PASSED [ 52%]
tests/test_handles.py::TestStatisticsCalculation::test_calculate_expected_sequence PASSED [ 52%]
tests/test_handles.py::TestConvenienceFunction::test_analyze_handle_gaps_returns_result PASSED [ 52%]
tests/test_handles.py::TestFormatGapReport::test_format_gap_report_no_gaps PASSED [ 52%]
tests/test_handles.py::TestFormatGapReport::test_format_gap_report_with_gaps PASSED [ 52%]
tests/test_handles.py::TestFormatGapReport::test_format_gap_report_with_errors PASSED [ 52%]
tests/test_handles.py::TestForensicScenarios::test_detect_mass_deletion PASSED [ 53%]
tests/test_handles.py::TestForensicScenarios::test_detect_selective_deletion PASSED [ 53%]
tests/test_handles.py::TestForensicScenarios::test_normal_editing_gaps PASSED [ 53%]
tests/test_handles.py::TestSectionMapParameter::test_parse_with_section_map_parameter PASSED [ 53%]
tests/test_handles.py::TestSectionMapParameter::test_parse_skips_parsing_when_section_map_provided PASSED [ 53%]
tests/test_header.py::TestHeaderParser::test_parse_ac1032 PASSED         [ 53%]
tests/test_header.py::TestHeaderParser::test_parse_ac1027 PASSED         [ 53%]
tests/test_header.py::TestHeaderParser::test_parse_ac1024 PASSED         [ 53%]
tests/test_header.py::TestHeaderParser::test_legacy_version_ac1015 PASSED [ 53%]
tests/test_header.py::TestHeaderParser::test_truly_unsupported_version PASSED [ 53%]
tests/test_header.py::TestHeaderParser::test_invalid_file PASSED         [ 53%]
tests/test_header.py::TestHeaderParser::test_too_small_file PASSED       [ 53%]
tests/test_header.py::TestHeaderParser::test_nonexistent_file PASSED     [ 54%]
tests/test_header.py::TestHeaderParser::test_supported_versions_constant PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_dwg_versions_mapping PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_parse_directory_raises_error PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_parse_ac1021 PASSED         [ 54%]
tests/test_header.py::TestHeaderParser::test_parse_ac1018 PASSED         [ 54%]
tests/test_header.py::TestHeaderParser::test_parse_ac1014 PASSED         [ 54%]
tests/test_header.py::TestHeaderParser::test_parse_ac1012 PASSED         [ 54%]
tests/test_header.py::TestHeaderParser::test_get_min_header_size_full_support PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_get_min_header_size_legacy PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_get_min_header_size_unknown PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_read_version_string PASSED  [ 54%]
tests/test_header.py::TestHeaderParser::test_read_version_string_with_null PASSED [ 54%]
tests/test_header.py::TestHeaderParser::test_validate_version_supported PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_validate_version_unsupported PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_validate_version_invalid PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_byte PASSED            [ 55%]
tests/test_header.py::TestHeaderParser::test_read_uint16 PASSED          [ 55%]
tests/test_header.py::TestHeaderParser::test_read_uint32 PASSED          [ 55%]
tests/test_header.py::TestHeaderParser::test_parse_version_specific_unknown PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_file_too_small_for_version_header PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_byte_out_of_bounds PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_uint16_out_of_bounds PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_uint32_out_of_bounds PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_parse_version_specific_unknown_fallback PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_version_string_invalid_prefix PASSED [ 55%]
tests/test_header.py::TestHeaderParser::test_read_version_string_decode_error PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_get_crc_offset_full_support_versions PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_get_crc_offset_ac1021 PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_get_crc_offset_ac1018 PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_get_crc_offset_ac1015 PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_get_crc_offset_r13_returns_none PASSED [ 56%]
tests/test_header.py::TestHeaderParser::test_has_full_support PASSED     [ 56%]
tests/test_header.py::TestHeaderParser::test_has_crc_support PASSED      [ 56%]
tests/test_header.py::TestHeaderParser::test_has_watermark_support PASSED [ 56%]
tests/test_intake.py::TestFileIntakeInitialization::test_init_creates_instance PASSED [ 56%]
tests/test_intake.py::TestFileIntakeInitialization::test_init_with_string_paths PASSED [ 56%]
tests/test_intake.py::TestFileIntakeInitialization::test_init_creates_evidence_dir_if_missing PASSED [ 56%]
tests/test_intake.py::TestHashCalculation::test_calculate_hashes_returns_all_algorithms PASSED [ 56%]
tests/test_intake.py::TestHashCalculation::test_calculate_hashes_correct_values PASSED [ 57%]
tests/test_intake.py::TestEvidenceCopying::test_copy_to_evidence_creates_file PASSED [ 57%]
tests/test_intake.py::TestEvidenceCopying::test_copy_to_evidence_creates_directory_structure PASSED [ 57%]
tests/test_intake.py::TestEvidenceCopying::test_copy_preserves_filename PASSED [ 57%]
tests/test_intake.py::TestReadOnlyProtection::test_set_read_only_removes_write_permission PASSED [ 57%]
tests/test_intake.py::TestCopyVerification::test_verify_copy_returns_true_for_identical PASSED [ 57%]
tests/test_intake.py::TestCopyVerification::test_verify_copy_returns_false_for_different PASSED [ 57%]
tests/test_intake.py::TestFullIntakeWorkflow::test_intake_creates_evidence_record PASSED [ 57%]
tests/test_intake.py::TestFullIntakeWorkflow::test_intake_protects_evidence_file PASSED [ 57%]
tests/test_intake.py::TestFullIntakeWorkflow::test_intake_calculates_correct_hashes PASSED [ 57%]
tests/test_intake.py::TestFullIntakeWorkflow::test_intake_with_evidence_number PASSED [ 57%]
tests/test_intake.py::TestFullIntakeWorkflow::test_intake_with_notes PASSED [ 57%]
tests/test_intake.py::TestIntakeFileFunction::test_intake_file_function_works PASSED [ 58%]
tests/test_intake.py::TestErrorHandling::test_intake_nonexistent_file_raises_error PASSED [ 58%]
tests/test_intake.py::TestErrorHandling::test_intake_invalid_dwg_raises_error PASSED [ 58%]
tests/test_intake.py::TestErrorHandling::test_intake_directory_raises_error PASSED [ 58%]
tests/test_intake.py::TestIntegration::test_full_intake_cycle PASSED     [ 58%]
tests/test_intake.py::TestIntegration::test_multiple_evidence_same_case PASSED [ 58%]
tests/test_intake.py::TestEvidenceDirectoryCreationError::test_init_raises_intake_error_when_dir_creation_fails PASSED [ 58%]
tests/test_intake.py::TestDuplicateEvidenceFile::test_intake_raises_error_for_duplicate PASSED [ 58%]
tests/test_intake.py::TestCleanupMethod::test_cleanup_removes_read_only_file PASSED [ 58%]
tests/test_intake.py::TestCleanupMethod::test_cleanup_handles_nonexistent_file PASSED [ 58%]
tests/test_intake.py::TestContextManagerIntake::test_file_intake_context_manager PASSED [ 58%]
tests/test_intake.py::TestContextManagerIntake::test_file_intake_close_method PASSED [ 58%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_hash_calculation_error PASSED [ 58%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_copy_error PASSED [ 59%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_read_only_error PASSED [ 59%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_verify_error PASSED [ 59%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_hash_mismatch PASSED [ 59%]
tests/test_intake.py::TestIntakeErrorPaths::test_intake_with_database_error PASSED [ 59%]
tests/test_integration.py::TestFullForensicWorkflow::test_complete_analysis_to_report_workflow PASSED [ 59%]
tests/test_integration.py::TestFullForensicWorkflow::test_analysis_with_corrupted_file_workflow PASSED [ 59%]
tests/test_integration.py::TestChainOfCustodyWorkflow::test_complete_custody_workflow PASSED [ 59%]
tests/test_integration.py::TestChainOfCustodyWorkflow::test_custody_detects_tampering PASSED [ 59%]
tests/test_integration.py::TestTamperingDetectionWorkflow::test_tampering_analysis_workflow PASSED [ 59%]
tests/test_integration.py::TestTamperingDetectionWorkflow::test_tampering_with_corrupted_file PASSED [ 59%]
tests/test_integration.py::TestTamperingDetectionWorkflow::test_tampering_analysis_json_export PASSED [ 59%]
tests/test_integration.py::TestAuditLoggingWorkflow::test_audit_trail_throughout_workflow PASSED [ 59%]
tests/test_integration.py::TestCLIIntegration::test_cli_analyze_to_json_workflow PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_tampering_command PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_report_generation PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_expert_witness_command PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_timeline_command PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_list_rules_command PASSED [ 60%]
tests/test_integration.py::TestCLIIntegration::test_cli_full_workflow PASSED [ 60%]
tests/test_integration.py::TestEdgeCasesAndErrorHandling::test_handles_very_small_file PASSED [ 60%]
tests/test_integration.py::TestEdgeCasesAndErrorHandling::test_handles_invalid_file PASSED [ 60%]
tests/test_integration.py::TestEdgeCasesAndErrorHandling::test_handles_nonexistent_file PASSED [ 60%]
tests/test_integration.py::TestEdgeCasesAndErrorHandling::test_handles_legacy_version PASSED [ 60%]
tests/test_integration.py::TestEdgeCasesAndErrorHandling::test_handles_truly_unsupported_version PASSED [ 60%]
tests/test_integration.py::TestCrossModuleIntegration::test_analysis_to_hex_dump_integration PASSED [ 60%]
tests/test_integration.py::TestCrossModuleIntegration::test_analysis_model_serialization_roundtrip PASSED [ 61%]
tests/test_integration.py::TestCrossModuleIntegration::test_all_risk_levels_handled PASSED [ 61%]
tests/test_integration.py::TestConcurrencyAndPerformance::test_multiple_analyses_sequential PASSED [ 61%]
tests/test_integration.py::TestConcurrencyAndPerformance::test_reusing_analyzer_instance PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_datetime PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_path PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_enum PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_uuid PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_pydantic_model PASSED [ 61%]
tests/test_json_export.py::TestForensicJSONEncoder::test_encode_unsupported_type_raises PASSED [ 61%]
tests/test_json_export.py::TestJSONExporter::test_to_dict PASSED         [ 61%]
tests/test_json_export.py::TestJSONExporter::test_to_json PASSED         [ 61%]
tests/test_json_export.py::TestJSONExporter::test_to_json_indent PASSED  [ 62%]
tests/test_json_export.py::TestJSONExporter::test_to_file PASSED         [ 62%]
tests/test_json_export.py::TestJSONExporter::test_to_file_creates_parent_dirs PASSED [ 62%]
tests/test_json_export.py::TestExportToJson::test_export_returns_string PASSED [ 62%]
tests/test_json_export.py::TestExportToJson::test_export_with_output_path PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_standard_info_creation PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_legal_case_info_creation PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_technique_info_creation PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_tampering_indicator_info_creation PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_knowledge_creation PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_knowledge_citation_summary PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_knowledge_standards_summary PASSED [ 62%]
tests/test_knowledge.py::TestForensicKnowledgeModels::test_forensic_knowledge_admissibility_statement PASSED [ 62%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_client_initialization_defaults PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_client_initialization_custom PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_client_connect_without_neo4j_driver PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_client_close_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_execute_query_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_forensic_standards_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_legal_cases_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_forensic_techniques_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_tampering_indicators_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_indicators_by_rule_ids_empty PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_all_knowledge_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestNeo4jKnowledgeClient::test_get_case_by_name_without_connection PASSED [ 63%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enricher_initialization_without_client PASSED [ 63%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enricher_initialization_with_client PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enrich_analysis_with_fallback PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enrich_analysis_without_fallback PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enrich_analysis_matches_indicators_to_rules PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enrich_analysis_ntfs_rules PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_enrich_analysis_timestamp_rules PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_get_citation_for_report_daubert PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_get_citation_for_report_lorraine PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_get_citation_for_report_not_found PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_get_standards_compliance_statement PASSED [ 64%]
tests/test_knowledge.py::TestKnowledgeEnricher::test_expert_context_critical_findings PASSED [ 64%]
tests/test_knowledge.py::TestFallbackData::test_fallback_standards_populated PASSED [ 64%]
tests/test_knowledge.py::TestFallbackData::test_fallback_legal_cases_populated PASSED [ 64%]
tests/test_knowledge.py::TestFallbackData::test_fallback_techniques_populated PASSED [ 65%]
tests/test_knowledge.py::TestFallbackData::test_fallback_indicators_populated PASSED [ 65%]
tests/test_knowledge.py::TestFallbackData::test_rule_to_indicator_map_coverage PASSED [ 65%]
tests/test_knowledge.py::TestKnowledgeEnricherWithMockedNeo4j::test_enrich_from_neo4j_success PASSED [ 65%]
tests/test_knowledge.py::TestKnowledgeEnricherWithMockedNeo4j::test_enrich_fallback_on_neo4j_error PASSED [ 65%]
tests/test_knowledge.py::TestKnowledgeEnricherWithMockedNeo4j::test_enrich_neo4j_empty_results_uses_fallback PASSED [ 65%]
tests/test_knowledge.py::TestReliabilityLevel::test_reliability_levels PASSED [ 65%]
tests/test_knowledge.py::TestReliabilityLevel::test_reliability_from_string PASSED [ 65%]
tests/test_knowledge.py::TestForensicKnowledgeAnalyzerIntegration::test_analyzer_enables_knowledge_by_default PASSED [ 65%]
tests/test_knowledge.py::TestForensicKnowledgeAnalyzerIntegration::test_analyzer_disables_knowledge PASSED [ 65%]
tests/test_knowledge.py::TestForensicKnowledgeAnalyzerIntegration::test_analyzer_custom_neo4j_params PASSED [ 65%]
tests/test_llm.py::TestOllamaResponse::test_default_values PASSED        [ 65%]
tests/test_llm.py::TestOllamaResponse::test_all_fields PASSED            [ 66%]
tests/test_llm.py::TestOllamaResponse::test_error_response PASSED        [ 66%]
tests/test_llm.py::TestOllamaClientInit::test_default_initialization PASSED [ 66%]
tests/test_llm.py::TestOllamaClientInit::test_custom_base_url PASSED     [ 66%]
tests/test_llm.py::TestOllamaClientInit::test_base_url_trailing_slash_removed PASSED [ 66%]
tests/test_llm.py::TestOllamaClientInit::test_custom_model PASSED        [ 66%]
tests/test_llm.py::TestOllamaClientInit::test_custom_timeout PASSED      [ 66%]
tests/test_llm.py::TestOllamaClientIsAvailable::test_is_available_success PASSED [ 66%]
tests/test_llm.py::TestOllamaClientIsAvailable::test_is_available_url_error PASSED [ 66%]
tests/test_llm.py::TestOllamaClientIsAvailable::test_is_available_http_error PASSED [ 66%]
tests/test_llm.py::TestOllamaClientIsAvailable::test_is_available_timeout PASSED [ 66%]
tests/test_llm.py::TestOllamaClientGetVersion::test_get_version_success PASSED [ 66%]
tests/test_llm.py::TestOllamaClientGetVersion::test_get_version_connection_error PASSED [ 66%]
tests/test_llm.py::TestOllamaClientGetVersion::test_get_version_invalid_json PASSED [ 67%]
tests/test_llm.py::TestOllamaClientListModels::test_list_models_success PASSED [ 67%]
tests/test_llm.py::TestOllamaClientListModels::test_list_models_empty PASSED [ 67%]
tests/test_llm.py::TestOllamaClientListModels::test_list_models_connection_error PASSED [ 67%]
tests/test_llm.py::TestOllamaClientIsModelAvailable::test_model_available_exact_match PASSED [ 67%]
tests/test_llm.py::TestOllamaClientIsModelAvailable::test_model_available_base_name_match PASSED [ 67%]
tests/test_llm.py::TestOllamaClientIsModelAvailable::test_model_not_available PASSED [ 67%]
tests/test_llm.py::TestOllamaClientIsModelAvailable::test_model_available_uses_default PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_success PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_with_system_prompt PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_with_custom_model PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_http_error PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_connection_error PASSED [ 67%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_timeout PASSED [ 68%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_invalid_json PASSED [ 68%]
tests/test_llm.py::TestOllamaClientGenerate::test_generate_with_max_tokens PASSED [ 68%]
tests/test_llm.py::TestNarrativeResult::test_successful_result PASSED    [ 68%]
tests/test_llm.py::TestNarrativeResult::test_failed_result PASSED        [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_default_initialization PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_disabled_narrator PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_custom_client PASSED   [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_custom_model PASSED    [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_custom_expert_name PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_default_expert_name PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorInit::test_get_system_prompt_uses_expert_name PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorIsAvailable::test_not_available_when_disabled PASSED [ 68%]
tests/test_llm.py::TestForensicNarratorIsAvailable::test_available_when_ollama_running PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorIsAvailable::test_not_available_when_ollama_not_running PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorIsAvailable::test_is_available_cached PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateFullAnalysis::test_not_available_returns_failure PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateFullAnalysis::test_successful_generation PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateFullAnalysis::test_generation_with_tampering PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateFullAnalysis::test_generation_failure PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateFullAnalysis::test_empty_response_handled PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateSectionAnalysis::test_section_not_available_returns_failure PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateSectionAnalysis::test_crc_section_analysis PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateSectionAnalysis::test_timestamps_section_analysis PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateSectionAnalysis::test_summary_section_analysis PASSED [ 69%]
tests/test_llm.py::TestForensicNarratorGenerateSectionAnalysis::test_unknown_section_handled PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_contains_file_info PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_contains_header_info PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_contains_crc_info PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_with_metadata PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_with_network_paths PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_with_anomalies PASSED [ 70%]
tests/test_llm.py::TestForensicNarratorBuildPrompt::test_prompt_with_ntfs_analysis PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_template_has_placeholder PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_template_can_be_formatted PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_contains_methodology PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_contains_rules PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_contains_dwg_knowledge PASSED [ 70%]
tests/test_llm.py::TestSystemPrompts::test_forensic_expert_prompt_contains_ntfs_knowledge PASSED [ 71%]
tests/test_llm.py::TestSystemPrompts::test_full_analysis_prompt_contains_placeholders PASSED [ 71%]
tests/test_llm.py::TestEdgeCases::test_narrator_with_minimal_analysis PASSED [ 71%]
tests/test_llm.py::TestEdgeCases::test_prompt_handles_none_metadata PASSED [ 71%]
tests/test_llm.py::TestEdgeCases::test_prompt_handles_empty_anomalies PASSED [ 71%]
tests/test_models.py::TestFileInfo::test_valid_file_info PASSED          [ 71%]
tests/test_models.py::TestFileInfo::test_sha256_normalization PASSED     [ 71%]
tests/test_models.py::TestFileInfo::test_invalid_sha256_length PASSED    [ 71%]
tests/test_models.py::TestFileInfo::test_invalid_sha256_characters PASSED [ 71%]
tests/test_models.py::TestHeaderAnalysis::test_valid_header_analysis PASSED [ 71%]
tests/test_models.py::TestCRCValidation::test_valid_crc PASSED           [ 71%]
tests/test_models.py::TestCRCValidation::test_invalid_crc PASSED         [ 71%]
tests/test_models.py::TestAnomaly::test_create_anomaly PASSED            [ 71%]
tests/test_models.py::TestTamperingIndicator::test_create_tampering_indicator PASSED [ 72%]
tests/test_models.py::TestTamperingIndicator::test_confidence_bounds PASSED [ 72%]
tests/test_models.py::TestRiskAssessment::test_create_risk_assessment PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSTimestamps::test_default_values PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSTimestamps::test_with_all_values PASSED [ 72%]
tests/test_ntfs_parser.py::TestFileNameTimestamps::test_default_values PASSED [ 72%]
tests/test_ntfs_parser.py::TestFileNameTimestamps::test_with_values PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_default_values PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_has_timestomping_evidence_false PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_has_timestomping_evidence_si_fn_mismatch PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_has_timestomping_evidence_nanoseconds_truncated PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_has_timestomping_evidence_creation_after_modification PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSForensicData::test_has_timestomping_evidence_multiple_indicators PASSED [ 72%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserInit::test_init_detects_windows PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserInit::test_init_on_windows PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserInit::test_init_on_unix PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserParse::test_parse_nonexistent_file_raises PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserParse::test_parse_existing_file PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserParse::test_parse_returns_timestamps PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserParse::test_parse_string_path PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserStatParsing::test_stat_parses_file_size PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserStatParsing::test_stat_parses_readonly_flag PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserStatParsing::test_stat_parses_writable_file PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_to_int PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_to_int_zero PASSED [ 73%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_int_to_datetime_valid PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_int_to_datetime_with_nanoseconds PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_int_to_datetime_zero PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserFiletimeConversion::test_filetime_int_to_datetime_negative PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_no_anomalies_clean_file PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_detects_nanosecond_truncation_multiple PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_no_truncation_single_zero PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_detects_creation_after_modification PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_no_creation_after_mod_normal_case PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_detects_si_fn_mismatch PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserAnomalyDetection::test_no_si_fn_mismatch_consistent PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_no_contradictions_consistent_timestamps PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_detects_dwg_created_before_file_existed PASSED [ 74%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_detects_dwg_modified_before_file_existed PASSED [ 75%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_detects_modification_timestamp_gap PASSED [ 75%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_no_gap_warning_for_small_difference PASSED [ 75%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_cross_validation_with_naive_datetimes PASSED [ 75%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_cross_validation_with_none_values PASSED [ 75%]
tests/test_ntfs_parser.py::TestNTFSTimestampParserCrossValidation::test_cross_validation_partial_timestamps PASSED [ 75%]
tests/test_ntfs_parser.py::TestConvenienceFunction::test_get_ntfs_timestamps PASSED [ 75%]
tests/test_ntfs_parser.py::TestConvenienceFunction::test_get_ntfs_timestamps_nonexistent PASSED [ 75%]
tests/test_ntfs_parser.py::TestWindowsAPIIntegration::test_windows_api_called_on_windows PASSED [ 75%]
tests/test_ntfs_parser.py::TestWindowsAPIIntegration::test_windows_api_not_called_on_unix FAILED [ 75%]
tests/test_ntfs_parser.py::TestEdgeCases::test_empty_file PASSED         [ 75%]
tests/test_ntfs_parser.py::TestEdgeCases::test_large_file_metadata PASSED [ 75%]
tests/test_ntfs_parser.py::TestEdgeCases::test_path_with_spaces PASSED   [ 75%]
tests/test_ntfs_parser.py::TestEdgeCases::test_unicode_path PASSED       [ 76%]
tests/test_ntfs_parser.py::TestEdgeCases::test_timestamps_in_far_past PASSED [ 76%]
tests/test_ntfs_parser.py::TestEdgeCases::test_timestamps_in_far_future PASSED [ 76%]
tests/test_ntfs_parser.py::TestForensicScenarios::test_scenario_classic_timestomping PASSED [ 76%]
tests/test_ntfs_parser.py::TestForensicScenarios::test_scenario_file_copy_detection PASSED [ 76%]
tests/test_ntfs_parser.py::TestForensicScenarios::test_scenario_legitimate_file PASSED [ 76%]
tests/test_ntfs_parser.py::TestConstants::test_filetime_epoch PASSED     [ 76%]
tests/test_ntfs_parser.py::TestConstants::test_filetime_to_unix_epoch_ticks PASSED [ 76%]
tests/test_provenance_detector.py::TestFileProvenance::test_default_initialization PASSED [ 76%]
tests/test_provenance_detector.py::TestFileProvenance::test_custom_initialization PASSED [ 76%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_revit_export_detection PASSED [ 76%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_oda_tool_detection FAILED [ 76%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_file_transfer_detection PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_native_autocad_detection PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_revit FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_oda_tool FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_file_transfer FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_file_not_found_error PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetector::test_convenience_function PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceIntegration::test_provenance_in_analyzer_workflow FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceIntegration::test_skip_rules_passed_to_engine FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceIntegration::test_rule_engine_skip_functionality PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceIntegration::test_error_handling_in_provenance_detection FAILED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetectionOrder::test_revit_takes_priority_over_fingerprint PASSED [ 77%]
tests/test_provenance_detector.py::TestProvenanceDetectionOrder::test_fingerprint_used_when_not_revit PASSED [ 77%]
tests/test_reports.py::TestHexDumpFormatter::test_format_empty_data PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_simple_data PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_with_offset PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_without_ascii PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_lowercase PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_non_printable PASSED [ 78%]
tests/test_reports.py::TestHexDumpFormatter::test_format_with_highlight PASSED [ 78%]
tests/test_reports.py::TestFormatHexDumpFunction::test_format_hex_dump_basic PASSED [ 78%]
tests/test_reports.py::TestFormatHexDumpFunction::test_format_hex_dump_with_params PASSED [ 78%]
tests/test_reports.py::TestTimelineEvent::test_event_creation PASSED     [ 78%]
tests/test_reports.py::TestTimelineEvent::test_event_comparison PASSED   [ 78%]
tests/test_reports.py::TestTimelineGenerator::test_generate_ascii_empty PASSED [ 78%]
tests/test_reports.py::TestTimelineGenerator::test_generate_ascii_with_events PASSED [ 78%]
tests/test_reports.py::TestTimelineGenerator::test_generate_svg_empty PASSED [ 79%]
tests/test_reports.py::TestTimelineGenerator::test_generate_svg_with_events PASSED [ 79%]
tests/test_reports.py::TestTimelineGenerator::test_extract_events_from_analysis PASSED [ 79%]
tests/test_reports.py::TestGenerateTimelineFunction::test_generate_timeline_ascii PASSED [ 79%]
tests/test_reports.py::TestGenerateTimelineFunction::test_generate_timeline_svg PASSED [ 79%]
tests/test_reports.py::TestPDFReportGenerator::test_generator_init PASSED [ 79%]
tests/test_reports.py::TestPDFReportGenerator::test_generate_report PASSED [ 79%]
tests/test_reports.py::TestPDFReportGenerator::test_generate_report_with_case_id PASSED [ 79%]
tests/test_reports.py::TestPDFReportGenerator::test_generate_report_with_hex_dump PASSED [ 79%]
tests/test_reports.py::TestGeneratePDFReportFunction::test_generate_pdf_report_basic PASSED [ 79%]
tests/test_reports.py::TestGeneratePDFReportFunction::test_generate_pdf_report_with_all_options PASSED [ 79%]
tests/test_reports.py::TestExpertWitnessGenerator::test_generator_init PASSED [ 79%]
tests/test_reports.py::TestExpertWitnessGenerator::test_generator_defaults PASSED [ 79%]
tests/test_reports.py::TestExpertWitnessGenerator::test_generate_methodology_document PASSED [ 80%]
tests/test_reports.py::TestExpertWitnessGenerator::test_generate_with_case_id PASSED [ 80%]
tests/test_reports.py::TestGenerateExpertWitnessDocumentFunction::test_generate_basic PASSED [ 80%]
tests/test_reports.py::TestGenerateExpertWitnessDocumentFunction::test_generate_with_all_options PASSED [ 80%]
tests/test_reports.py::TestReportIntegration::test_full_report_workflow PASSED [ 80%]
tests/test_reports.py::TestReportIntegration::test_reports_for_corrupted_file PASSED [ 80%]
tests/test_reports.py::TestReportIntegration::test_hex_dump_file_region PASSED [ 80%]
tests/test_revit_detection.py::TestRevitExportType::test_export_types_defined PASSED [ 80%]
tests/test_revit_detection.py::TestRevitExportType::test_export_type_values PASSED [ 80%]
tests/test_revit_detection.py::TestRevitSignature::test_signature_creation PASSED [ 80%]
tests/test_revit_detection.py::TestRevitSignature::test_signature_high_confidence PASSED [ 80%]
tests/test_revit_detection.py::TestRevitDetectionResult::test_result_creation PASSED [ 80%]
tests/test_revit_detection.py::TestRevitDetectionResult::test_result_with_all_fields PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorInitialization::test_detector_creation PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorInitialization::test_detector_has_signatures_list PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorSignatures::test_revit_signatures_defined PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorSignatures::test_app_markers_defined PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorNonRevitFiles::test_empty_file_not_revit PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorNonRevitFiles::test_standard_autocad_header_not_revit PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorNonRevitFiles::test_non_dwg_file_not_revit PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorRevitFiles::test_header_signature_detection PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorRevitFiles::test_app_marker_detection PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorRevitFiles::test_object_class_detection PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorRevitFiles::test_multiple_signatures_higher_confidence PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorVersionExtraction::test_extract_revit_2022 PASSED [ 81%]
tests/test_revit_detection.py::TestRevitDetectorVersionExtraction::test_extract_revit_2023 PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorVersionExtraction::test_no_version_returns_none PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorExportTypes::test_detect_3d_export PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorExportTypes::test_detect_link_export PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorExportTypes::test_default_2d_export PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorForensicNotes::test_high_confidence_notes PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorForensicNotes::test_low_confidence_warning PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorForensicNotes::test_forensic_notes_mention_crc PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorWithBytes::test_detect_from_bytes PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorWithBytes::test_detect_from_bytes_non_revit PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorErrorHandling::test_nonexistent_file PASSED [ 82%]
tests/test_revit_detection.py::TestRevitDetectorErrorHandling::test_invalid_path PASSED [ 82%]
tests/test_revit_detection.py::TestDetectRevitExportConvenienceFunction::test_convenience_function PASSED [ 82%]
tests/test_revit_detection.py::TestDetectRevitExportConvenienceFunction::test_convenience_function_with_bytes PASSED [ 83%]
tests/test_revit_detection.py::TestRevitDetectorConfidenceCalculation::test_object_class_highest_weight PASSED [ 83%]
tests/test_revit_detection.py::TestRevitDetectorConfidenceCalculation::test_zero_signatures_zero_confidence PASSED [ 83%]
tests/test_revit_detection.py::TestRevitDetectorConfidenceCalculation::test_confidence_capped_at_one PASSED [ 83%]
tests/test_rules_fingerprint.py::TestHelperMethods::test_get_forensic_meta_returns_dict PASSED [ 83%]
tests/test_rules_fingerprint.py::TestHelperMethods::test_get_forensic_meta_returns_data PASSED [ 83%]
tests/test_rules_fingerprint.py::TestHelperMethods::test_check_trusted_dwg_false_when_missing PASSED [ 83%]
tests/test_rules_fingerprint.py::TestHelperMethods::test_check_trusted_dwg_true_when_autodesk PASSED [ 83%]
tests/test_rules_fingerprint.py::TestODAArtifacts::test_detects_oda_from_fingerprint PASSED [ 83%]
tests/test_rules_fingerprint.py::TestODAArtifacts::test_detects_oda_from_forensic_meta_bricscad PASSED [ 83%]
tests/test_rules_fingerprint.py::TestODAArtifacts::test_detects_oda_from_forensic_meta_nanocad PASSED [ 83%]
tests/test_rules_fingerprint.py::TestODAArtifacts::test_no_oda_for_autocad PASSED [ 83%]
tests/test_rules_fingerprint.py::TestODAArtifacts::test_no_detection_empty_context PASSED [ 83%]
tests/test_rules_fingerprint.py::TestBricsCADSignature::test_detects_bricscad_from_fingerprint PASSED [ 84%]
tests/test_rules_fingerprint.py::TestBricsCADSignature::test_detects_bricscad_from_forensic_meta PASSED [ 84%]
tests/test_rules_fingerprint.py::TestBricsCADSignature::test_detects_bricsys_from_forensic_meta PASSED [ 84%]
tests/test_rules_fingerprint.py::TestBricsCADSignature::test_no_detection_for_autocad PASSED [ 84%]
tests/test_rules_fingerprint.py::TestNanoCADSignature::test_detects_nanocad_from_fingerprint PASSED [ 84%]
tests/test_rules_fingerprint.py::TestNanoCADSignature::test_detects_nanocad_from_forensic_meta PASSED [ 84%]
tests/test_rules_fingerprint.py::TestNanoCADSignature::test_detects_cyrillic_codepage PASSED [ 84%]
tests/test_rules_fingerprint.py::TestNanoCADSignature::test_no_detection_for_autocad PASSED [ 84%]
tests/test_rules_fingerprint.py::TestDraftSightSignature::test_detects_draftsight_from_fingerprint PASSED [ 84%]
tests/test_rules_fingerprint.py::TestDraftSightSignature::test_detects_draftsight_from_forensic_meta PASSED [ 84%]
tests/test_rules_fingerprint.py::TestDraftSightSignature::test_detects_dassault_from_forensic_meta PASSED [ 84%]
tests/test_rules_fingerprint.py::TestDraftSightSignature::test_no_detection_for_autocad PASSED [ 84%]
tests/test_rules_fingerprint.py::TestZeroTimestampPattern::test_detects_zero_timestamps PASSED [ 85%]
tests/test_rules_fingerprint.py::TestZeroTimestampPattern::test_detects_identical_with_zero_tdindwg PASSED [ 85%]
tests/test_rules_fingerprint.py::TestZeroTimestampPattern::test_no_detection_for_valid_timestamps PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_detects_missing_guids PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_passes_with_valid_guids PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_detects_null_guids PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_critical_when_trusted_dwg_says_autodesk PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_no_detection_with_empty_metadata PASSED [ 85%]
tests/test_rules_fingerprint.py::TestMissingAutoCADIdentifiers::test_revit_export_passes_missing_identifiers PASSED [ 85%]
tests/test_rules_fingerprint.py::TestRevitExportDetection::test_detects_revit_from_guid_pattern PASSED [ 85%]
tests/test_rules_fingerprint.py::TestRevitExportDetection::test_detects_revit_from_revit_detection_context PASSED [ 85%]
tests/test_rules_fingerprint.py::TestRevitExportDetection::test_detects_revit_from_crc_flag PASSED [ 85%]
tests/test_rules_fingerprint.py::TestRevitExportDetection::test_no_detection_for_autocad PASSED [ 85%]
tests/test_rules_fingerprint.py::TestRevitExportDetection::test_helper_method_check_revit_export PASSED [ 86%]
tests/test_rules_fingerprint.py::TestZeroTimestampWithRevit::test_revit_export_passes_zero_timestamps PASSED [ 86%]
tests/test_sections.py::TestSectionTypeEnum::test_section_type_values PASSED [ 86%]
tests/test_sections.py::TestSectionTypeEnum::test_section_type_is_int PASSED [ 86%]
tests/test_sections.py::TestSectionTypeEnum::test_all_forensic_sections_defined PASSED [ 86%]
tests/test_sections.py::TestSectionNames::test_all_section_types_have_names PASSED [ 86%]
tests/test_sections.py::TestSectionNames::test_header_section_name PASSED [ 86%]
tests/test_sections.py::TestSectionNames::test_handles_section_name PASSED [ 86%]
tests/test_sections.py::TestSectionNames::test_appinfo_section_name PASSED [ 86%]
tests/test_sections.py::TestSectionNames::test_signature_section_name PASSED [ 86%]
tests/test_sections.py::TestSectionInfo::test_section_info_creation PASSED [ 86%]
tests/test_sections.py::TestSectionInfo::test_section_info_defaults PASSED [ 86%]
tests/test_sections.py::TestSectionInfo::test_section_info_with_all_fields PASSED [ 86%]
tests/test_sections.py::TestSectionInfo::test_section_info_integer_type PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_empty_result PASSED   [ 87%]
tests/test_sections.py::TestSectionMapResult::test_has_section_true PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_has_section_false PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_get_section_exists PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_get_section_not_exists PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_multiple_sections PASSED [ 87%]
tests/test_sections.py::TestSectionMapResult::test_parsing_errors_accumulate PASSED [ 87%]
tests/test_sections.py::TestSectionMapParser::test_parser_initialization PASSED [ 87%]
tests/test_sections.py::TestSectionMapParser::test_parser_constants PASSED [ 87%]
tests/test_sections.py::TestSectionMapParserFileTooSmall::test_file_too_small PASSED [ 87%]
tests/test_sections.py::TestSectionMapParserFileTooSmall::test_file_exactly_min_size PASSED [ 87%]
tests/test_sections.py::TestSectionMapParserVersions::test_parse_ac1018_version PASSED [ 87%]
tests/test_sections.py::TestSectionMapParserVersions::test_parse_ac1021_version PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserVersions::test_parse_ac1024_version PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserVersions::test_parse_ac1027_version PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserVersions::test_parse_ac1032_version PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserVersions::test_unsupported_version PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserVersions::test_invalid_version_string PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserFileAccess::test_file_not_found PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserFileAccess::test_permission_denied PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserFileAccess::test_path_as_string PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserInvalidAddresses::test_zero_section_map_address PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserInvalidAddresses::test_address_beyond_file_size PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserSectionScanning::test_find_header_section PASSED [ 88%]
tests/test_sections.py::TestSectionMapParserSectionScanning::test_find_handles_section PASSED [ 89%]
tests/test_sections.py::TestSectionMapParserSectionScanning::test_section_count_updated PASSED [ 89%]
tests/test_sections.py::TestSectionMapParserSectionScanning::test_r2004_section_scanning PASSED [ 89%]
tests/test_sections.py::TestSectionMapParserSectionScanning::test_r2007_section_scanning PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_uncompressed_section PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_compressed_section_invalid_zlib PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_section_with_valid_dwg_compression PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_section_no_decompress PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_section_file_not_found PASSED [ 89%]
tests/test_sections.py::TestReadSectionData::test_read_section_at_end_of_file PASSED [ 89%]
tests/test_sections.py::TestGetSectionMapConvenience::test_get_section_map_returns_result PASSED [ 89%]
tests/test_sections.py::TestGetSectionMapConvenience::test_get_section_map_with_invalid_file PASSED [ 89%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_identifies_missing_header_section PASSED [ 89%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_identifies_missing_handles_section PASSED [ 90%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_identifies_signature_section PASSED [ 90%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_identifies_security_section PASSED [ 90%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_section_size_anomaly_detection PASSED [ 90%]
tests/test_sections.py::TestSectionMapForensicCapabilities::test_compression_ratio_check PASSED [ 90%]
tests/test_sections.py::TestVersionCoverage::test_ac1018_supported PASSED [ 90%]
tests/test_sections.py::TestVersionCoverage::test_ac1021_supported PASSED [ 90%]
tests/test_sections.py::TestVersionCoverage::test_ac1024_supported PASSED [ 90%]
tests/test_sections.py::TestVersionCoverage::test_ac1027_supported PASSED [ 90%]
tests/test_sections.py::TestVersionCoverage::test_ac1032_supported PASSED [ 90%]
tests/test_text_utils.py::TestSanitizeLLMOutputBasic::test_empty_string PASSED [ 90%]
tests/test_text_utils.py::TestSanitizeLLMOutputBasic::test_none_returns_empty PASSED [ 90%]
tests/test_text_utils.py::TestSanitizeLLMOutputBasic::test_plain_text_unchanged PASSED [ 90%]
tests/test_text_utils.py::TestSanitizeLLMOutputBasic::test_preserves_newlines PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_em_dash_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_en_dash_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_minus_sign_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_left_single_quote_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_left_double_quote_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_ellipsis_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_non_breaking_space_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_bullet_point_replaced PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeUnicodeCharacters::test_multiple_unicode_replacements PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeXMLEscaping::test_ampersand_escaped PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeXMLEscaping::test_less_than_escaped PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeXMLEscaping::test_greater_than_escaped PASSED [ 91%]
tests/test_text_utils.py::TestSanitizeXMLEscaping::test_all_xml_chars_escaped PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownBold::test_double_asterisk_bold PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownBold::test_double_underscore_bold PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownBold::test_multiple_bold_sections PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownItalic::test_single_asterisk_italic PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownItalic::test_underscore_not_converted_to_italic PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownItalic::test_standard_information_preserved PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownHeaders::test_h1_header_stripped PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownHeaders::test_h2_header_stripped PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownHeaders::test_h3_header_stripped PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeMarkdownHeaders::test_multiple_headers PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeHorizontalRules::test_dash_horizontal_rule_removed PASSED [ 92%]
tests/test_text_utils.py::TestSanitizeHorizontalRules::test_asterisk_horizontal_rule_removed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeHorizontalRules::test_long_horizontal_rule_removed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeMarkdownTables::test_table_separator_removed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeMarkdownTables::test_table_cells_converted PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeMarkdownTables::test_complex_table PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeCodeBlocks::test_fenced_code_block_removed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeCodeBlocks::test_inline_code_removed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeCodeBlocks::test_multiple_inline_code PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeWhitespace::test_excessive_newlines_reduced PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeWhitespace::test_leading_trailing_whitespace_stripped PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeUnclosedTags::test_unclosed_bold_tag_fixed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeUnclosedTags::test_unclosed_italic_tag_fixed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeUnclosedTags::test_multiple_unclosed_tags_fixed PASSED [ 93%]
tests/test_text_utils.py::TestSanitizeIntegration::test_complex_llm_output PASSED [ 94%]
tests/test_text_utils.py::TestSanitizeIntegration::test_ntfs_technical_terms_preserved PASSED [ 94%]
tests/test_text_utils.py::TestSanitizeIntegration::test_forensic_report_snippet PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_epoch_constant PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_to_datetime_zero PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_to_datetime_known_date PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_to_datetime_with_fraction PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_datetime_to_mjd_epoch PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_datetime_to_mjd_known_date PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_round_trip PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_mjd_to_datetime_negative_returns_epoch PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_datetime_to_mjd_before_epoch_returns_negative PASSED [ 94%]
tests/test_timestamp_parser.py::TestMJDConversion::test_datetime_to_mjd_naive_datetime PASSED [ 94%]
tests/test_timestamp_parser.py::TestTimestampData::test_default_values PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_calendar_span_days_basic PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_calendar_span_days_none_without_dates PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_timezone_offset_hours_basic PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_timezone_offset_hours_none_without_data PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_extraction_success_true PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_extraction_success_false PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdcreate_datetime PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdcreate_datetime_none PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdcreate_datetime_zero PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdupdate_datetime PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdupdate_datetime_none PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tducreate_datetime PASSED [ 95%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tducreate_datetime_none PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tducreate_datetime_zero PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tduupdate_datetime PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tduupdate_datetime_none PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tduupdate_datetime_zero PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdindwg_hours PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdindwg_hours_none PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdindwg_days PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdindwg_days_none PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdusrtimer_hours PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_get_tdusrtimer_hours_none PASSED [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_to_dict PASSED   [ 96%]
tests/test_timestamp_parser.py::TestTimestampData::test_to_dict_empty PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_init_creates_instance PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_returns_timestamp_data PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_empty_file_returns_empty_data PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_has_timestamp_support PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_has_timestamp_support_unsupported PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_file_not_found PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_small_file PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_detects_version PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_with_educational_watermark PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_student_version_marker PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParser::test_parse_with_valid_mjd_timestamps PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_valid_mjd_valid_values PASSED [ 97%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_valid_mjd_invalid_values PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_could_be_editing_time_valid PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_could_be_editing_time_negative PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_could_be_editing_time_exceeds_span PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_find_timestamp_clusters_empty PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_find_timestamp_clusters_consecutive PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_find_timestamp_clusters_non_consecutive PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_find_timestamp_clusters_single_values PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_assign_timestamps_from_cluster PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_assign_timestamps_from_cluster_four_values PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_detect_version_valid PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_detect_version_short_data PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_detect_version_non_ac PASSED [ 98%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_detect_version_decode_error PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_likely_guid_valid PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_likely_guid_all_zeros PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_likely_guid_all_ones PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_likely_guid_repeated_pattern PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_is_likely_guid_wrong_length PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_bytes_to_guid_string_valid PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_extract_login_name PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserInternals::test_extract_login_name_not_found PASSED [ 99%]
tests/test_timestamp_parser.py::TestGUIDExtraction::test_fingerprint_guid_format PASSED [ 99%]
tests/test_timestamp_parser.py::TestGUIDExtraction::test_version_guid_format PASSED [ 99%]
tests/test_timestamp_parser.py::TestGUIDExtraction::test_guids_can_be_none PASSED [ 99%]
tests/test_timestamp_parser.py::TestTimestampParserIntegration::test_full_parse_workflow PASSED [100%]

================================== FAILURES ===================================
________ TestWindowsAPIIntegration.test_windows_api_not_called_on_unix ________
tests\test_ntfs_parser.py:725: in test_windows_api_not_called_on_unix
    parser.parse(test_file)
dwg_forensic\parsers\ntfs.py:135: in parse
    file_path = Path(file_path)
                ^^^^^^^^^^^^^^^
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\pathlib.py:873: in __new__
    raise NotImplementedError("cannot instantiate %r on your system"
E   NotImplementedError: cannot instantiate 'PosixPath' on your system
_______________ TestProvenanceDetector.test_oda_tool_detection ________________
tests\test_provenance_detector.py:155: in test_oda_tool_detection
    assert provenance.source_application == "bricscad"
E   AssertionError: assert 'Unknown' == 'bricscad'
E     
E     - bricscad
E     + Unknown
__________ TestProvenanceDetector.test_confidence_calculation_revit ___________
tests\test_provenance_detector.py:249: in test_confidence_calculation_revit
    assert provenance.confidence == pytest.approx(0.95, abs=0.001)
E   assert 0.9300000000000002 == 0.95  0.001
E     
E     comparison failed
E     Obtained: 0.9300000000000002
E     Expected: 0.95  0.001
_________ TestProvenanceDetector.test_confidence_calculation_oda_tool _________
tests\test_provenance_detector.py:269: in test_confidence_calculation_oda_tool
    assert provenance.confidence == pytest.approx(0.80, abs=0.001)
E   assert 0.0 == 0.8  0.001
E     
E     comparison failed
E     Obtained: 0.0
E     Expected: 0.8  0.001
______ TestProvenanceDetector.test_confidence_calculation_file_transfer _______
tests\test_provenance_detector.py:296: in test_confidence_calculation_file_transfer
    assert provenance.confidence == pytest.approx(0.85, abs=0.001)
E   assert 0.0 == 0.85  0.001
E     
E     comparison failed
E     Obtained: 0.0
E     Expected: 0.85  0.001
_______ TestProvenanceIntegration.test_provenance_in_analyzer_workflow ________
tests\test_provenance_detector.py:345: in test_provenance_in_analyzer_workflow
    with patch.object(analyzer, '_parse_header'):
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491FA5ED90> does not have the attribute '_parse_header'
_________ TestProvenanceIntegration.test_skip_rules_passed_to_engine __________
tests\test_provenance_detector.py:378: in test_skip_rules_passed_to_engine
    with patch.object(analyzer, '_parse_header'):
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491FCFAC50> does not have the attribute '_parse_header'
____ TestProvenanceIntegration.test_error_handling_in_provenance_detection ____
tests\test_provenance_detector.py:432: in test_error_handling_in_provenance_detection
    with patch.object(analyzer, '_parse_header'):
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491F955290> does not have the attribute '_parse_header'
============================== warnings summary ===============================
dwg_forensic\knowledge\models.py:89
  C:\Users\JordanEhrig\Documents\GitHub\DWG-forensic-tool\dwg_forensic\knowledge\models.py:89: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ForensicKnowledge(BaseModel):

..\..\..\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pydantic\_internal\_generate_schema.py:319
  C:\Users\JordanEhrig\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pydantic\_internal\_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                                               Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------------
dwg_forensic\__init__.py                               3      0   100%
dwg_forensic\analysis\__init__.py                      5      0   100%
dwg_forensic\analysis\anomaly.py                     211     19    91%   71-79, 92-96, 110, 114, 161-162, 223, 225, 325-326, 396-397, 469
dwg_forensic\analysis\cad_fingerprinting.py          348    104    70%   654-655, 759-786, 817-842, 966-1104, 1137
dwg_forensic\analysis\provenance_detector.py         152      5    97%   117-118, 212, 312-320
dwg_forensic\analysis\risk.py                        103      1    99%   136
dwg_forensic\analysis\rules.py                         2      2     0%   13-22
dwg_forensic\analysis\rules\__init__.py                3      0   100%
dwg_forensic\analysis\rules\engine.py                104      8    92%   630-633, 699-700, 711, 722, 743
dwg_forensic\analysis\rules\models.py                 46      0   100%
dwg_forensic\analysis\rules\rules_basic.py           118      7    94%   59, 80, 99, 236, 251, 300, 410
dwg_forensic\analysis\rules\rules_fingerprint.py     207     16    92%   62-63, 69-70, 76-77, 314, 358-360, 422, 475, 530, 581-582, 584-585
dwg_forensic\analysis\rules\rules_ntfs.py            171     11    94%   126, 129, 382, 476, 535, 539, 647, 806-807, 809-810
dwg_forensic\analysis\rules\rules_structure.py       108     58    46%   41-57, 95, 128-129, 143, 195-261, 303-331, 387-394, 412, 432, 463
dwg_forensic\analysis\rules\rules_timestamp.py       106     10    91%   135-150, 400-401
dwg_forensic\analysis\smoking_gun.py                  84     14    83%   229, 313, 347, 368-371, 405-435
dwg_forensic\analysis\version_dates.py                45      0   100%
dwg_forensic\cli.py                                  608     94    85%   107, 112-113, 366-371, 391, 397-398, 400-401, 419-463, 468-470, 502-504, 507-508, 512-514, 870-882, 970-994, 998, 1020, 1108, 1154
dwg_forensic\core\__init__.py                          6      0   100%
dwg_forensic\core\analyzer.py                        558    168    70%   77-80, 86-88, 194-213, 217-231, 252-255, 316-325, 333-334, 340-349, 360, 362-363, 368, 377-386, 416-426, 444-449, 458, 467-476, 486, 489-498, 529-536, 611-620, 656-669, 677-758, 766-830, 851-852, 911-913, 961-963, 1143, 1163-1185, 1204, 1226, 1240, 1567, 1586-1587, 1612, 1625, 1661, 1663, 1665, 1667, 1669, 1673, 1675, 1764, 1769-1772, 1777-1780, 1785-1795, 1810-1817, 1846, 1851, 1856, 1861, 1872, 1878-1879
dwg_forensic\core\custody.py                         137      9    93%   182-183, 251-252, 261-265
dwg_forensic\core\database.py                         70      3    96%   82, 154, 220
dwg_forensic\core\file_guard.py                      109      2    98%   129-130
dwg_forensic\core\intake.py                          122      2    98%   254-255
dwg_forensic\gui.py                                  397    356    10%   23-26, 33-59, 63-83, 87-95, 100-149, 154-185, 189-195, 199-205, 210-236, 244-247, 251-294, 298-306, 310-363, 373-390, 394-406, 410-419, 423-435, 439-480, 484-555, 559-633, 637-638, 642-656, 660-712, 716-773, 777-807, 811, 824-834, 838
dwg_forensic\knowledge\__init__.py                     4      0   100%
dwg_forensic\knowledge\client.py                     155     92    41%   59-66, 70-73, 78-80, 103-109, 135, 170-178, 218-224, 265, 296-354, 381-389, 420-485
dwg_forensic\knowledge\enrichment.py                 107      9    92%   329, 335, 495-496, 498-499, 529-531
dwg_forensic\knowledge\models.py                      72      2    97%   114, 125
dwg_forensic\llm\__init__.py                           4      0   100%
dwg_forensic\llm\forensic_narrator.py                164     44    73%   408-409, 436, 445-454, 508, 512, 516, 522, 526-538, 541-553, 557, 638, 671-674
dwg_forensic\llm\forensic_reasoner.py                158    133    16%   24-26, 110-115, 119-203, 217-293, 297-301, 305-365, 377-410
dwg_forensic\llm\ollama_client.py                     79      0   100%
dwg_forensic\models.py                               156      0   100%
dwg_forensic\output\__init__.py                        6      0   100%
dwg_forensic\output\expert_witness.py                191     51    73%   41-43, 85-102, 210-211, 364-475, 603, 618-639
dwg_forensic\output\hex_dump.py                       72      2    97%   134, 226
dwg_forensic\output\json_export.py                    41      2    95%   44, 50
dwg_forensic\output\pdf_report.py                    544    132    76%   55-57, 270-273, 317-318, 521, 523, 615-617, 682-683, 698, 703-705, 758-827, 854-869, 1174-1239, 1253-1265, 1309-1350, 1359-1370, 1377-1382, 1399-1403, 1442, 1466, 1476, 1485, 1494, 1503, 1511, 1519, 1535, 1567-1572
dwg_forensic\output\text_utils.py                     47      1    98%   105
dwg_forensic\output\timeline.py                       82      2    98%   107, 115
dwg_forensic\parsers\__init__.py                      10      0   100%
dwg_forensic\parsers\compression.py                  126     10    92%   159, 178, 186, 210, 234, 240-248
dwg_forensic\parsers\crc.py                           90     12    87%   29-30, 93-94, 114, 146-156, 244, 265
dwg_forensic\parsers\drawing_vars.py                 436    199    54%   140, 260-262, 265-266, 270-274, 312-370, 388-473, 487-523, 547-570, 593-706, 733-784, 799-800, 843-844, 868-869, 896, 898, 905-906, 956-957, 970-971, 989-990, 1045-1059
dwg_forensic\parsers\encryption.py                    85     16    81%   55-56, 116, 175-177, 247-265
dwg_forensic\parsers\handles.py                      298     67    78%   238-240, 256-257, 280-308, 326-347, 364-380, 393-394, 405-406, 438-448, 476, 503-514, 593, 600, 620, 665, 693
dwg_forensic\parsers\header.py                       148      6    96%   132-135, 156-157
dwg_forensic\parsers\metadata.py                     253    253     0%   13-455
dwg_forensic\parsers\ntfs.py                         172      5    97%   181-182, 220, 271-273
dwg_forensic\parsers\revit_detection.py              154      9    94%   265, 271, 286-287, 362, 393-394, 423, 428
dwg_forensic\parsers\sections.py                     368    189    49%   40-41, 219-227, 237-244, 262, 292-295, 321-322, 339-340, 353-354, 371-372, 379, 382, 387-388, 406-455, 474-520, 569-571, 602-686, 748-774, 792-801, 824-889, 913-938, 949-950
dwg_forensic\parsers\structure_analysis.py           167     49    71%   168-171, 210-213, 222-224, 229-230, 238-239, 242-243, 246-247, 250-251, 255-256, 259-260, 277, 280-283, 287-289, 302-303, 307-308, 312-314, 318-320, 329-331, 339, 346, 372, 407-408
dwg_forensic\parsers\timestamp.py                    244     11    95%   352-353, 377-378, 386, 486-487, 529-530, 561-562
dwg_forensic\utils\__init__.py                         3      0   100%
dwg_forensic\utils\audit.py                          170      3    98%   307, 325, 327
dwg_forensic\utils\diagnostics.py                     28      0   100%
dwg_forensic\utils\exceptions.py                      79      1    99%   248
--------------------------------------------------------------------------------
TOTAL                                               8536   2189    74%
=========================== short test summary info ===========================
FAILED tests/test_ntfs_parser.py::TestWindowsAPIIntegration::test_windows_api_not_called_on_unix - NotImplementedError: cannot instantiate 'PosixPath' on your system
FAILED tests/test_provenance_detector.py::TestProvenanceDetector::test_oda_tool_detection - AssertionError: assert 'Unknown' == 'bricscad'
  
  - bricscad
  + Unknown
FAILED tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_revit - assert 0.9300000000000002 == 0.95  0.001
  
  comparison failed
  Obtained: 0.9300000000000002
  Expected: 0.95  0.001
FAILED tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_oda_tool - assert 0.0 == 0.8  0.001
  
  comparison failed
  Obtained: 0.0
  Expected: 0.8  0.001
FAILED tests/test_provenance_detector.py::TestProvenanceDetector::test_confidence_calculation_file_transfer - assert 0.0 == 0.85  0.001
  
  comparison failed
  Obtained: 0.0
  Expected: 0.85  0.001
FAILED tests/test_provenance_detector.py::TestProvenanceIntegration::test_provenance_in_analyzer_workflow - AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491FA5ED90> does not have the attribute '_parse_header'
FAILED tests/test_provenance_detector.py::TestProvenanceIntegration::test_skip_rules_passed_to_engine - AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491FCFAC50> does not have the attribute '_parse_header'
FAILED tests/test_provenance_detector.py::TestProvenanceIntegration::test_error_handling_in_provenance_detection - AttributeError: <dwg_forensic.core.analyzer.ForensicAnalyzer object at 0x000002491F955290> does not have the attribute '_parse_header'
================= 8 failed, 1266 passed, 2 warnings in 15.20s =================
